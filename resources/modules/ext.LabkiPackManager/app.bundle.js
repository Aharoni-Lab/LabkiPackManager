var Vue="undefined"!=typeof mw&&mw.loader&&mw.loader.require?mw.loader.require("vue"):window.Vue,Codex="undefined"!=typeof mw&&mw.loader&&mw.loader.require?mw.loader.require("@wikimedia/codex")||mw.loader.require("codex"):window.Codex,mermaid=function(){try{if("undefined"!=typeof window&&window.mermaid)return window.mermaid;if("undefined"!=typeof mw&&mw.loader&&mw.loader.require){var e=mw.loader.require("ext.mermaid");if(e?.initialize)return e;if(e?.mermaid?.initialize)return e.mermaid;if(e?.default?.initialize)return e.default}}catch(e){}return window.mermaid}();!function(e,a){"use strict";const t=e.reactive({repoUrl:"",ref:"",mermaidSrc:"",hierarchy:null,packs:{},stateHash:"",warnings:[],busy:!1,selectedRepo:null,repos:[]});function o(){return new mw.Api}async function n(e){try{return await e()}catch(e){throw console.error("API call failed:",e),e}}async function r(e,a){return n(async()=>{const t=o();return(await t.post({action:"labkiReposAdd",format:"json",repo_url:e,default_ref:a})).labkiReposAdd})}async function l(e,a){return n(async()=>{const t=o(),n=await t.get({action:"labkiGraphGet",format:"json",repo_url:e,ref:a});console.log("[graphGet] Response:",n);let r=n.labkiGraphGet;if(!r){if(!(n.graph&&n.repo_url&&n.ref))throw new Error("Invalid graphGet response structure");console.log("[graphGet] Using unwrapped response"),r=n}return r})}async function i(e,a){return n(async()=>{const t=o(),n=await t.get({action:"labkiHierarchyGet",format:"json",repo_url:e,ref:a});console.log("[hierarchyGet] Response:",n);let r=n.labkiHierarchyGet;if(!r){if(!(n.hierarchy&&n.repo_url&&n.ref))throw new Error("Invalid hierarchyGet response structure");console.log("[hierarchyGet] Using unwrapped response"),r=n}return r})}async function c(e){return n(async()=>{const a=o();console.log("[packsAction] Sending payload:",e);const t=await a.post({action:"labkiPacksAction",format:"json",payload:JSON.stringify(e)});console.log("[packsAction] Raw response:",t);let n=t.labkiPacksAction;if(!n)throw console.error("[packsAction] Cannot find labkiPacksAction in response:",JSON.stringify(t,null,2)),new Error("Invalid packsAction response structure");return console.log("[packsAction] Returning:",n),n})}const s={class:"add-repo-form"},d={class:"error"};var p={__name:"AddRepoModal",props:{modelValue:Boolean},emits:["update:modelValue","added"],setup(t,{emit:o}){const n=t,l=o,i=e.computed({get:()=>n.modelValue,set:e=>l("update:modelValue",e)}),c=e.ref(""),p=e.ref("main"),u=e.ref(""),m=e.ref(""),f=e.ref(!1),k=e.computed(()=>""!==c.value.trim()&&""!==p.value.trim()&&!u.value);function g(){u.value="";const e=c.value.trim();if(e)try{new URL(e),e.match(/^(https?|git|ssh):\/\//)||(u.value=mw.msg("labkipackmanager-error-invalid-protocol"))}catch{u.value=mw.msg("labkipackmanager-error-invalid-url")}}async function v(){if(k.value&&!f.value){f.value=!0,m.value="";try{await r(c.value.trim(),p.value.trim()),l("added",c.value.trim()),y()}catch(e){m.value=e instanceof Error?e.message:String(e)}finally{f.value=!1}}}function y(){c.value="",p.value="main",u.value="",m.value="",i.value=!1}function h(e){return mw.msg(e)}return(t,o)=>(e.openBlock(),e.createBlock(e.unref(a.CdxDialog),{open:i.value,"onUpdate:open":o[2]||(o[2]=e=>i.value=e),title:h("labkipackmanager-add-repo-title"),"primary-action":{label:h("labkipackmanager-add-repo-submit"),actionType:"progressive",disabled:f.value||!k.value},"default-action":{label:h("labkipackmanager-cancel")},onPrimary:v,onDefault:y},{default:e.withCtx(()=>[e.createElementVNode("div",s,[e.createVNode(e.unref(a.CdxField),{"is-fieldset":!1},e.createSlots({label:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(h("labkipackmanager-repo-url-label")),1)]),default:e.withCtx(()=>[e.createVNode(e.unref(a.CdxTextInput),{modelValue:c.value,"onUpdate:modelValue":[o[0]||(o[0]=e=>c.value=e),g],placeholder:h("labkipackmanager-repo-url-placeholder"),disabled:f.value},null,8,["modelValue","placeholder","disabled"])]),_:2},[u.value?{name:"help-text",fn:e.withCtx(()=>[e.createElementVNode("span",d,e.toDisplayString(u.value),1)]),key:"0"}:void 0]),1024),e.createVNode(e.unref(a.CdxField),{"is-fieldset":!1},{label:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(h("labkipackmanager-default-ref-label")),1)]),default:e.withCtx(()=>[e.createVNode(e.unref(a.CdxTextInput),{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=e=>p.value=e),placeholder:h("labkipackmanager-default-ref-placeholder"),disabled:f.value},null,8,["modelValue","placeholder","disabled"])]),_:1}),m.value?(e.openBlock(),e.createBlock(e.unref(a.CdxMessage),{key:0,type:"error",inline:!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.value),1)]),_:1})):e.createCommentVNode("v-if",!0)])]),_:1},8,["open","title","primary-action","default-action"]))},__scopeId:"data-v-0cf6aec2",__file:"resources/src/ui/AddRepoModal.vue"};const u={class:"add-ref-form"},m={class:"repo-info"};var f={__name:"AddRefModal",props:{modelValue:Boolean,repoUrl:String},emits:["update:modelValue","added"],setup(t,{emit:o}){const n=t,l=o,i=e.computed({get:()=>n.modelValue,set:e=>l("update:modelValue",e)}),c=e.ref(""),s=e.ref(""),d=e.ref(!1),p=e.computed(()=>""!==c.value.trim());async function f(){if(p.value&&!d.value){d.value=!0,s.value="";try{await r(n.repoUrl,c.value.trim()),l("added",c.value.trim()),k()}catch(e){s.value=e instanceof Error?e.message:String(e)}finally{d.value=!1}}}function k(){c.value="",s.value="",i.value=!1}function g(e){return mw.msg(e)}return(o,n)=>(e.openBlock(),e.createBlock(e.unref(a.CdxDialog),{open:i.value,"onUpdate:open":n[1]||(n[1]=e=>i.value=e),title:g("labkipackmanager-add-ref-title"),"primary-action":{label:g("labkipackmanager-add-ref-submit"),actionType:"progressive",disabled:d.value||!p.value},"default-action":{label:g("labkipackmanager-cancel")},onPrimary:f,onDefault:k},{default:e.withCtx(()=>[e.createElementVNode("div",u,[e.createElementVNode("p",m,[e.createElementVNode("strong",null,e.toDisplayString(g("labkipackmanager-repository"))+":",1),e.createTextVNode(" "+e.toDisplayString(t.repoUrl),1)]),e.createVNode(e.unref(a.CdxField),{"is-fieldset":!1},{label:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g("labkipackmanager-ref-name-label")),1)]),default:e.withCtx(()=>[e.createVNode(e.unref(a.CdxTextInput),{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=e=>c.value=e),placeholder:g("labkipackmanager-ref-name-placeholder"),disabled:d.value},null,8,["modelValue","placeholder","disabled"])]),_:1}),s.value?(e.openBlock(),e.createBlock(e.unref(a.CdxMessage),{key:0,type:"error",inline:!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(s.value),1)]),_:1})):e.createCommentVNode("v-if",!0)])]),_:1},8,["open","title","primary-action","default-action"]))},__scopeId:"data-v-f029ab7a",__file:"resources/src/ui/AddRefModal.vue"};const k={class:"repo-ref-selector"},g={class:"selector-row"},v={key:0,class:"current-selection"},y="__add_new_repo__",h="__add_new_ref__";var b={__name:"RepoRefSelector",setup(r){const s=e.ref(""),d=e.ref(""),u=e.ref(!1),m=e.ref(!1),b=e.ref(""),w=e.computed(()=>{if(console.log("Computing repoMenuItems, store.repos:",t.repos),!t.repos||0===t.repos.length)return[{label:"Loading...",value:"",disabled:!0}];const e=t.repos.map(e=>({label:e.repo_url,value:e.repo_url}));return e.push({label:"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€",value:"__separator__",disabled:!0}),e.push({label:M("labkipackmanager-add-repo-option"),value:y}),e}),_=e.computed(()=>{if(!t.selectedRepo)return[];const e=t.selectedRepo.refs.map(e=>({label:`${e.ref_name} ${e.is_default?"(default)":""}`,value:e.ref}));return e.push({label:"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€",value:"__separator__",disabled:!0}),e.push({label:M("labkipackmanager-add-ref-option"),value:h}),e});async function V(){try{console.log("[loadRepos] Starting..."),t.busy=!0,b.value="",console.log("[loadRepos] Calling reposList API...");const e=await async function(){return n(async()=>{console.log("[reposList] Starting API call...");const e=o();console.log("[reposList] API instance:",e);const a=await e.get({action:"labkiReposList",format:"json"});if(console.log("[reposList] Raw API response:",a),console.log("[reposList] Response keys:",Object.keys(a)),!a)throw new Error("No response from API");let t=a.labkiReposList;if(!t){if(!a.repos||!a.meta)throw console.error("[reposList] Cannot find repos data in response:",JSON.stringify(a,null,2)),new Error("Invalid API response structure - no labkiReposList field and no repos field");console.log("[reposList] Response appears to be unwrapped, using directly"),t=a}return console.log("[reposList] Data structure:",t),console.log("[reposList] Returning:",t),t})}();if(console.log("[loadRepos] API response received:",e),!e)throw new Error("No response from reposList API");if(!e.repos)throw new Error("Invalid response structure - no repos field. Response: "+JSON.stringify(e));console.log("[loadRepos] Setting store.repos:",e.repos),t.repos=e.repos,console.log("[loadRepos] store.repos is now:",t.repos),console.log("[loadRepos] store.repos.length:",t.repos.length),t.repos.length>0&&!s.value&&(console.log("[loadRepos] Auto-selecting first repo:",t.repos[0].repo_url),await B(t.repos[0].repo_url))}catch(e){console.error("[loadRepos] Error:",e),b.value=e instanceof Error?e.message:String(e)}finally{t.busy=!1,console.log("[loadRepos] Finished. store.busy:",t.busy,"store.repos:",t.repos)}}async function N(e){if(e===y)return u.value=!0,void(s.value=t.repoUrl);"string"==typeof e&&e&&"__separator__"!==e&&await B(e)}async function B(e){try{t.busy=!0,b.value="",s.value=e,t.repoUrl=e;const a=t.repos.find(a=>a.repo_url===e);if(!a)throw new Error(M("labkipackmanager-error-repo-not-found"));t.selectedRepo=a;const o=a.refs.find(e=>e.is_default),n=o?.ref||a.refs[0]?.ref;n&&await E(n)}catch(e){b.value=e instanceof Error?e.message:String(e)}finally{t.busy=!1}}async function S(e){if(e===h)return m.value=!0,void(d.value=t.ref);"string"==typeof e&&e&&"__separator__"!==e&&await E(e)}async function E(e){try{t.busy=!0,b.value="",d.value=e,t.ref=e;const[a,o]=await Promise.all([l(t.repoUrl,t.ref),i(t.repoUrl,t.ref)]);t.mermaidSrc=function(e){const a=["graph TD"],t=new Set,o=[];for(const a of e.containsEdges||[])t.add(a.from),t.add(a.to),o.push({from:a.from,to:a.to,type:"contains"});for(const a of e.dependsEdges||[])t.add(a.from),t.add(a.to),o.push({from:a.from,to:a.to,type:"depends"});for(const e of t)a.push(`  ${D(e)}["${e}"]`);for(const e of o){const t=D(e.from),o=D(e.to);"depends"===e.type?a.push(`  ${t} -.-> ${o}`):a.push(`  ${t} --\x3e ${o}`)}const n=a.join("\n");return console.log("[buildMermaidFromGraph] Generated Mermaid syntax:\n",n),n}(a.graph),t.hierarchy=o.hierarchy;const n=await c({command:"init",repo_url:t.repoUrl,ref:t.ref,data:{}});t.packs=n.diff,t.stateHash=n.state_hash,t.warnings=n.warnings}catch(e){b.value=e instanceof Error?e.message:String(e)}finally{t.busy=!1}}async function C(e){await V(),await B(e)}async function x(e){s.value&&(await V(),await E(e))}function D(e){return e.replace(/[^a-zA-Z0-9_]/g,"_")}function M(e){return mw.msg(e)}return e.onMounted(async()=>{console.log("RepoRefSelector mounted, store:",t),await V()}),(o,n)=>(e.openBlock(),e.createElementBlock("div",k,[e.createElementVNode("h2",null,e.toDisplayString(M("labkipackmanager-select-source")),1),e.createElementVNode("div",g,[e.createVNode(e.unref(a.CdxField),{class:"selector-field"},{label:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(M("labkipackmanager-repo-selector-label")),1)]),default:e.withCtx(()=>[e.createVNode(e.unref(a.CdxSelect),{selected:s.value,"onUpdate:selected":[n[0]||(n[0]=e=>s.value=e),N],"menu-items":w.value,disabled:e.unref(t).busy},null,8,["selected","menu-items","disabled"])]),_:1}),e.createVNode(e.unref(a.CdxField),{class:"selector-field"},{label:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(M("labkipackmanager-ref-selector-label")),1)]),default:e.withCtx(()=>[e.createVNode(e.unref(a.CdxSelect),{selected:d.value,"onUpdate:selected":[n[1]||(n[1]=e=>d.value=e),S],"menu-items":_.value,disabled:e.unref(t).busy||!s.value},null,8,["selected","menu-items","disabled"])]),_:1})]),s.value&&d.value?(e.openBlock(),e.createElementBlock("div",v,[e.createElementVNode("strong",null,e.toDisplayString(M("labkipackmanager-current-selection"))+":",1),e.createTextVNode(" "+e.toDisplayString(s.value)+" @ "+e.toDisplayString(d.value),1)])):e.createCommentVNode("v-if",!0),b.value?(e.openBlock(),e.createBlock(e.unref(a.CdxMessage),{key:1,type:"error",inline:!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.value),1)]),_:1})):e.createCommentVNode("v-if",!0),e.createVNode(p,{modelValue:u.value,"onUpdate:modelValue":n[2]||(n[2]=e=>u.value=e),onAdded:C},null,8,["modelValue"]),e.createVNode(f,{modelValue:m.value,"onUpdate:modelValue":n[3]||(n[3]=e=>m.value=e),"repo-url":s.value,onAdded:x},null,8,["modelValue","repo-url"])]))},__scopeId:"data-v-a9c77630",__file:"resources/src/ui/RepoRefSelector.vue"};const w={class:"mermaid-graph-container"},_={key:0,class:"no-mermaid-message"},V={key:1,class:"mermaid-wrapper"},N={class:"mermaid"},B={key:2,class:"no-graph-message"};var S={__name:"MermaidGraph",props:{mermaidSrc:String},setup(t){const o=t,n=e.ref(!1);function r(e){return mw.msg(e)}return e.onMounted(()=>{!function(){const e=mw.loader.getState("ext.mermaid");n.value="ready"===e||"loaded"===e||"loading"===e,n.value?console.log("[MermaidGraph] Mermaid extension is available, state:",e):console.warn("Mermaid extension is not available")}()}),e.watch(()=>o.mermaidSrc,async()=>{n.value&&o.mermaidSrc&&(await e.nextTick(),function(){if(console.log("[MermaidGraph] Triggering Mermaid render"),"undefined"!=typeof window&&window.mermaid)try{"function"==typeof window.mermaid.contentLoaded?window.mermaid.contentLoaded():"function"==typeof window.mermaid.run?window.mermaid.run():console.warn("[MermaidGraph] No suitable mermaid render method found")}catch(e){console.warn("[MermaidGraph] Failed to trigger mermaid render:",e)}else console.warn("[MermaidGraph] window.mermaid not available")}())}),(o,l)=>(e.openBlock(),e.createElementBlock("div",w,[e.createElementVNode("h3",null,e.toDisplayString(r("labkipackmanager-graph-title")),1),n.value?t.mermaidSrc?(e.openBlock(),e.createElementBlock("div",V,[e.createElementVNode("pre",N,e.toDisplayString(t.mermaidSrc),1)])):(e.openBlock(),e.createElementBlock("div",B,[e.createElementVNode("p",null,e.toDisplayString(r("labkipackmanager-no-graph-loaded")),1)])):(e.openBlock(),e.createElementBlock("div",_,[e.createVNode(e.unref(a.CdxMessage),{type:"warning",inline:!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(r("labkipackmanager-mermaid-not-installed")),1)]),_:1})]))]))}};function E(e,a){for(const[t,o]of Object.entries(a)){const a=e[t]??{};e[t]=C(a,o)}}function C(e,a){const t={...e,...a};if(a.pages){t.pages={...e.pages??{}};for(const[e,o]of Object.entries(a.pages)){const a=t.pages[e]??{};t.pages[e]=x(a,o)}}return t}function x(e,a){return{...e,...a}}S.__scopeId="data-v-04226ecd",S.__file="resources/src/ui/MermaidGraph.vue";const D={key:1,class:"expand-spacer"},M={class:"node-content"},R={class:"node-label"},A={class:"node-icon"},L={key:0,class:"node-version"},P={key:0,class:"node-description"},T={key:1,class:"node-depends"},U={key:2,class:"node-actions"},I={key:0,class:"node-children"};var G={__name:"TreeNode",props:{node:Object,depth:Number},emits:["select-pack","deselect-pack"],setup(o,{emit:n}){const r=o,l=n,i=e.ref(r.depth<2),c=e.computed(()=>"pack"!==r.node.type?null:t.packs[r.node.label]||null),s=e.computed(()=>c.value?c.value.auto_selected?"status-auto":c.value.selected?"status-selected":"":""),d=e.computed(()=>c.value?c.value.auto_selected?`(${f("labkipackmanager-auto-selected")})`:c.value.selected?`(${f("labkipackmanager-selected")})`:"":"");function p(){i.value=!i.value}function u(){l("select-pack",r.node.label)}function m(){l("deselect-pack",r.node.label)}function f(e){return mw.msg(e)}return(t,n)=>{const r=e.resolveComponent("tree-node",!0);return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["tree-node",{"is-pack":"pack"===o.node.type,"is-page":"page"===o.node.type}])},[e.createElementVNode("div",{class:"node-header",style:e.normalizeStyle({paddingLeft:24*o.depth+"px"})},[o.node.children&&o.node.children.length>0?(e.openBlock(),e.createElementBlock("button",{key:0,class:"expand-button",onClick:p},e.toDisplayString(i.value?"â–¼":"â–¶"),1)):(e.openBlock(),e.createElementBlock("span",D)),e.createElementVNode("div",M,[e.createElementVNode("div",R,[e.createElementVNode("span",A,e.toDisplayString("pack"===o.node.type?"ðŸ“¦":"ðŸ“„"),1),e.createElementVNode("strong",null,e.toDisplayString(o.node.label),1),o.node.version?(e.openBlock(),e.createElementBlock("span",L,"v"+e.toDisplayString(o.node.version),1)):e.createCommentVNode("v-if",!0),c.value?(e.openBlock(),e.createElementBlock("span",{key:1,class:e.normalizeClass(["node-status",s.value])},e.toDisplayString(d.value),3)):e.createCommentVNode("v-if",!0)]),o.node.description?(e.openBlock(),e.createElementBlock("div",P,e.toDisplayString(o.node.description),1)):e.createCommentVNode("v-if",!0),o.node.depends_on&&o.node.depends_on.length>0?(e.openBlock(),e.createElementBlock("div",T,[e.createElementVNode("small",null,e.toDisplayString(f("labkipackmanager-depends-on"))+": "+e.toDisplayString(o.node.depends_on.join(", ")),1)])):e.createCommentVNode("v-if",!0),"pack"===o.node.type?(e.openBlock(),e.createElementBlock("div",U,[c.value?.selected||c.value?.auto_selected?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createBlock(e.unref(a.CdxButton),{key:0,size:"small",action:"progressive",onClick:u},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(f("labkipackmanager-select")),1)]),_:1})),c.value?.selected||c.value?.auto_selected?(e.openBlock(),e.createBlock(e.unref(a.CdxButton),{key:1,size:"small",action:"destructive",onClick:m},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(f("labkipackmanager-deselect")),1)]),_:1})):e.createCommentVNode("v-if",!0)])):e.createCommentVNode("v-if",!0)])],4),i.value&&o.node.children?(e.openBlock(),e.createElementBlock("div",I,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.node.children,a=>(e.openBlock(),e.createBlock(r,{key:a.id,node:a,depth:o.depth+1,onSelectPack:n[0]||(n[0]=e=>t.$emit("select-pack",e)),onDeselectPack:n[1]||(n[1]=e=>t.$emit("deselect-pack",e))},null,8,["node","depth"]))),128))])):e.createCommentVNode("v-if",!0)],2)}},__scopeId:"data-v-6225b7c8",__file:"resources/src/ui/TreeNode.vue"};const j={class:"hierarchy-tree-container"},F={key:0,class:"no-hierarchy"},H={key:1,class:"tree-content"},$={class:"tree-stats"},O={class:"tree-nodes"};var z={__name:"HierarchyTree",props:{hierarchy:Object},setup(a){async function o(e){await r("select_pack",{pack_name:e})}async function n(e){await r("deselect_pack",{pack_name:e})}async function r(e,a){if(!t.busy)try{t.busy=!0;const o=await c({command:e,repo_url:t.repoUrl,ref:t.ref,data:a});E(t.packs,o.diff),t.stateHash=o.state_hash,t.warnings=o.warnings}catch(e){console.error("Command failed:",e)}finally{t.busy=!1}}function l(e){return mw.msg(e)}return(t,r)=>(e.openBlock(),e.createElementBlock("div",j,[e.createElementVNode("h3",null,e.toDisplayString(l("labkipackmanager-hierarchy-title")),1),a.hierarchy?(e.openBlock(),e.createElementBlock("div",H,[e.createElementVNode("div",$,[e.createElementVNode("span",null,e.toDisplayString(l("labkipackmanager-pack-count"))+": "+e.toDisplayString(a.hierarchy.meta.pack_count),1),e.createElementVNode("span",null,e.toDisplayString(l("labkipackmanager-page-count"))+": "+e.toDisplayString(a.hierarchy.meta.page_count),1)]),e.createElementVNode("div",O,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.hierarchy.root_nodes,a=>(e.openBlock(),e.createBlock(G,{key:a.id,node:a,depth:0,onSelectPack:o,onDeselectPack:n},null,8,["node"]))),128))])])):(e.openBlock(),e.createElementBlock("div",F,[e.createElementVNode("p",null,e.toDisplayString(l("labkipackmanager-no-hierarchy-loaded")),1)]))]))},__scopeId:"data-v-adb05fca",__file:"resources/src/ui/HierarchyTree.vue"};const q={class:"details-panel"},J={class:"panel-content"},W={key:0,class:"warnings-section"},Z={key:1,class:"selected-packs-section"},K={class:"packs-list"},Q={class:"pack-header"},X={key:0,class:"pack-badge auto"},Y={key:1,class:"pack-badge manual"},ee={class:"pack-details"},ae={key:0},te={key:1},oe={key:2},ne={key:3},re={key:2,class:"no-selection"},le={key:3,class:"state-info"},ie={class:"action-buttons"};var ce={__name:"DetailsPanel",setup(o){const n=e.ref(""),r=e.ref(""),l=e.computed(()=>{const e=[];for(const[a,o]of Object.entries(t.packs))(o.selected||o.auto_selected)&&e.push({name:a,state:o,pageCount:Object.keys(o.pages||{}).length});return e});async function i(){if(!t.busy)try{t.busy=!0,n.value="",r.value="";const e=await c({command:"apply",repo_url:t.repoUrl,ref:t.ref,data:{}});E(t.packs,e.diff),t.stateHash=e.state_hash,t.warnings=e.warnings,e.operation?.operation_id?n.value=p("labkipackmanager-apply-success-with-id").replace("$1",e.operation.operation_id):n.value=p("labkipackmanager-apply-success")}catch(e){r.value=e instanceof Error?e.message:String(e)}finally{t.busy=!1}}async function s(){if(!t.busy)try{t.busy=!0,n.value="",r.value="";const e=await c({command:"refresh",repo_url:t.repoUrl,ref:t.ref,data:{}});E(t.packs,e.diff),t.stateHash=e.state_hash,t.warnings=e.warnings,n.value=p("labkipackmanager-refresh-success")}catch(e){r.value=e instanceof Error?e.message:String(e)}finally{t.busy=!1}}async function d(){if(!t.busy&&confirm(p("labkipackmanager-clear-confirm")))try{t.busy=!0,n.value="",r.value="";const e=await c({command:"clear",repo_url:t.repoUrl,ref:t.ref,data:{}});t.packs=e.diff,t.stateHash=e.state_hash,t.warnings=e.warnings,n.value=p("labkipackmanager-clear-success")}catch(e){r.value=e instanceof Error?e.message:String(e)}finally{t.busy=!1}}function p(e){return mw.msg(e)}return(o,c)=>(e.openBlock(),e.createElementBlock("div",q,[e.createElementVNode("h3",null,e.toDisplayString(p("labkipackmanager-details-title")),1),e.createElementVNode("div",J,[e.createCommentVNode(" Warnings Section "),e.unref(t).warnings.length>0?(e.openBlock(),e.createElementBlock("div",W,[e.createElementVNode("h4",null,e.toDisplayString(p("labkipackmanager-warnings")),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(t).warnings,(t,o)=>(e.openBlock(),e.createBlock(e.unref(a.CdxMessage),{key:o,type:"warning",inline:!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t),1)]),_:2},1024))),128))])):e.createCommentVNode("v-if",!0),e.createCommentVNode(" Selected Packs Section "),l.value.length>0?(e.openBlock(),e.createElementBlock("div",Z,[e.createElementVNode("h4",null,e.toDisplayString(p("labkipackmanager-selected-packs")),1),e.createElementVNode("div",K,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,a=>(e.openBlock(),e.createElementBlock("div",{key:a.name,class:"pack-item"},[e.createElementVNode("div",Q,[e.createElementVNode("strong",null,e.toDisplayString(a.name),1),a.state.auto_selected?(e.openBlock(),e.createElementBlock("span",X,e.toDisplayString(p("labkipackmanager-auto-selected")),1)):(e.openBlock(),e.createElementBlock("span",Y,e.toDisplayString(p("labkipackmanager-manually-selected")),1))]),e.createElementVNode("div",ee,[a.state.action?(e.openBlock(),e.createElementBlock("div",ae,[e.createElementVNode("small",null,e.toDisplayString(p("labkipackmanager-action"))+": "+e.toDisplayString(a.state.action),1)])):e.createCommentVNode("v-if",!0),a.state.target_version?(e.openBlock(),e.createElementBlock("div",te,[e.createElementVNode("small",null,e.toDisplayString(p("labkipackmanager-version"))+": "+e.toDisplayString(a.state.target_version),1)])):e.createCommentVNode("v-if",!0),a.state.prefix?(e.openBlock(),e.createElementBlock("div",oe,[e.createElementVNode("small",null,e.toDisplayString(p("labkipackmanager-prefix"))+": "+e.toDisplayString(a.state.prefix),1)])):e.createCommentVNode("v-if",!0),a.pageCount>0?(e.openBlock(),e.createElementBlock("div",ne,[e.createElementVNode("small",null,e.toDisplayString(p("labkipackmanager-pages"))+": "+e.toDisplayString(a.pageCount),1)])):e.createCommentVNode("v-if",!0)])]))),128))])])):(e.openBlock(),e.createElementBlock("div",re,[e.createElementVNode("p",null,e.toDisplayString(p("labkipackmanager-no-packs-selected")),1)])),e.createCommentVNode(" State Hash (Debug) "),e.unref(t).stateHash?(e.openBlock(),e.createElementBlock("div",le,[e.createElementVNode("small",null,[e.createTextVNode(e.toDisplayString(p("labkipackmanager-state-hash"))+": ",1),e.createElementVNode("code",null,e.toDisplayString(e.unref(t).stateHash),1)])])):e.createCommentVNode("v-if",!0),e.createCommentVNode(" Action Buttons "),e.createElementVNode("div",ie,[e.createVNode(e.unref(a.CdxButton),{action:"progressive",weight:"primary",disabled:e.unref(t).busy||0===l.value.length,onClick:i},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p("labkipackmanager-apply")),1)]),_:1},8,["disabled"]),e.createVNode(e.unref(a.CdxButton),{action:"default",disabled:e.unref(t).busy,onClick:s},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p("labkipackmanager-refresh")),1)]),_:1},8,["disabled"]),e.createVNode(e.unref(a.CdxButton),{action:"destructive",weight:"quiet",disabled:e.unref(t).busy,onClick:d},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p("labkipackmanager-clear")),1)]),_:1},8,["disabled"])]),e.createCommentVNode(" Operation Status "),n.value?(e.openBlock(),e.createBlock(e.unref(a.CdxMessage),{key:4,type:"success",inline:!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.value),1)]),_:1})):e.createCommentVNode("v-if",!0),r.value?(e.openBlock(),e.createBlock(e.unref(a.CdxMessage),{key:5,type:"error",inline:!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(r.value),1)]),_:1})):e.createCommentVNode("v-if",!0)])]))},__scopeId:"data-v-348c6e2c",__file:"resources/src/ui/DetailsPanel.vue"};const se={class:"labki-pack-manager-app"},de={class:"app-header"},pe={class:"app-description"},ue={key:0,class:"loading-overlay"},me={class:"loading-spinner"},fe={class:"app-main"};var ke={__name:"App",setup(a){function o(e){return mw.msg(e)}return e.onMounted(()=>{console.log("Labki Pack Manager initialized")}),(a,n)=>(e.openBlock(),e.createElementBlock("div",se,[e.createElementVNode("header",de,[e.createElementVNode("h1",null,e.toDisplayString(o("labkipackmanager-special-title")),1),e.createElementVNode("p",pe,e.toDisplayString(o("labkipackmanager-special-description")),1)]),e.unref(t).busy?(e.openBlock(),e.createElementBlock("div",ue,[e.createElementVNode("div",me,e.toDisplayString(o("labkipackmanager-loading"))+"... ",1)])):e.createCommentVNode("v-if",!0),e.createElementVNode("main",fe,[e.createVNode(b),e.unref(t).repoUrl&&e.unref(t).ref?(e.openBlock(),e.createBlock(S,{key:0,"mermaid-src":e.unref(t).mermaidSrc},null,8,["mermaid-src"])):e.createCommentVNode("v-if",!0),e.unref(t).repoUrl&&e.unref(t).ref?(e.openBlock(),e.createBlock(z,{key:1,hierarchy:e.unref(t).hierarchy},null,8,["hierarchy"])):e.createCommentVNode("v-if",!0),e.unref(t).repoUrl&&e.unref(t).ref?(e.openBlock(),e.createBlock(ce,{key:2})):e.createCommentVNode("v-if",!0)])]))}};ke.__scopeId="data-v-23151fc9",ke.__file="resources/src/ui/App.vue",console.log("Labki Pack Manager: main.ts loading..."),console.log("Labki Pack Manager: imports complete"),console.log("Labki Pack Manager: Checking MediaWiki environment..."),"undefined"!=typeof mw&&mw.loader?(console.log("Labki Pack Manager: MediaWiki environment available, starting bootstrap"),console.log("Labki Pack Manager: bootstrap called"),mw.loader.using(["vue","mediawiki.api","@wikimedia/codex","codex-styles"]).then(()=>{console.log("Labki Pack Manager: All modules loaded, initializing app"),function(){console.log("Labki Pack Manager: initApp called");const a=document.getElementById("labki-pack-manager-root");a?(console.log("Labki Pack Manager: Root element found, creating app"),e.createApp(ke).mount(a),console.log("Labki Pack Manager: Application mounted")):console.error("Labki Pack Manager: Root element not found")}()}).catch(e=>{console.error("Labki Pack Manager: Failed to load required modules",e)})):console.error("Labki Pack Manager: MediaWiki environment not available")}(Vue,Codex);
//# sourceMappingURL=app.bundle.js.map
