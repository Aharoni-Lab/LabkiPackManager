{"version":3,"file":"app.bundle.js","sources":["../../src/state/store.ts","../../src/api/mwApi.ts","../../src/api/endpoints.ts","../../src/ui/AddRepoModal.vue","../../src/ui/AddRefModal.vue","../../src/ui/RepoRefSelector.vue","../../src/ui/MermaidGraph.vue","../../src/state/merge.ts","../../src/ui/TreeNode.vue","../../src/ui/HierarchyTree.vue","../../src/ui/DetailsPanel.vue","../../src/ui/App.vue","../../src/main.ts"],"sourcesContent":[null,null,null,"<template>\n  <cdx-dialog\n    v-model:open=\"isOpen\"\n    :title=\"$t('labkipackmanager-add-repo-title')\"\n    :primary-action=\"{\n      label: $t('labkipackmanager-add-repo-submit'),\n      actionType: 'progressive',\n      disabled: busy || !isValid\n    }\"\n    :default-action=\"{\n      label: $t('labkipackmanager-cancel')\n    }\"\n    @primary=\"onSubmit\"\n    @default=\"onCancel\"\n  >\n    <div class=\"add-repo-form\">\n      <cdx-field\n        :is-fieldset=\"false\"\n      >\n        <template #label>{{ $t('labkipackmanager-repo-url-label') }}</template>\n        <cdx-text-input\n          v-model=\"repoUrl\"\n          :placeholder=\"$t('labkipackmanager-repo-url-placeholder')\"\n          :disabled=\"busy\"\n          @update:model-value=\"validateUrl\"\n        />\n        <template v-if=\"urlError\" #help-text>\n          <span class=\"error\">{{ urlError }}</span>\n        </template>\n      </cdx-field>\n\n      <cdx-field\n        :is-fieldset=\"false\"\n      >\n        <template #label>{{ $t('labkipackmanager-default-ref-label') }}</template>\n        <cdx-text-input\n          v-model=\"defaultRef\"\n          :placeholder=\"$t('labkipackmanager-default-ref-placeholder')\"\n          :disabled=\"busy\"\n        />\n      </cdx-field>\n\n      <cdx-message\n        v-if=\"statusMessage && !error\"\n        type=\"notice\"\n        :inline=\"true\"\n      >\n        {{ statusMessage }}\n      </cdx-message>\n\n      <cdx-message\n        v-if=\"error\"\n        type=\"error\"\n        :inline=\"true\"\n      >\n        {{ error }}\n      </cdx-message>\n    </div>\n  </cdx-dialog>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue';\nimport { CdxDialog, CdxField, CdxTextInput, CdxMessage } from '@wikimedia/codex';\nimport { reposAdd, pollOperation } from '../api/endpoints';\n\nconst props = defineProps({\n  modelValue: Boolean\n});\n\nconst emit = defineEmits(['update:modelValue', 'added']);\n\nconst isOpen = computed({\n  get: () => props.modelValue,\n  set: (value) => emit('update:modelValue', value)\n});\n\nconst repoUrl = ref('');\nconst defaultRef = ref('main');\nconst urlError = ref('');\nconst error = ref('');\nconst busy = ref(false);\nconst statusMessage = ref('');\n\nconst isValid = computed(() => {\n  return repoUrl.value.trim() !== '' && defaultRef.value.trim() !== '' && !urlError.value;\n});\n\nfunction validateUrl() {\n  urlError.value = '';\n  const url = repoUrl.value.trim();\n  \n  if (!url) {\n    return;\n  }\n\n  // Basic URL validation\n  try {\n    new URL(url);\n    if (!url.match(/^(https?|git|ssh):\\/\\//)) {\n      urlError.value = mw.msg('labkipackmanager-error-invalid-protocol');\n    }\n  } catch {\n    urlError.value = mw.msg('labkipackmanager-error-invalid-url');\n  }\n}\n\nasync function onSubmit() {\n  if (!isValid.value || busy.value) {\n    return;\n  }\n\n  busy.value = true;\n  error.value = '';\n\n  try {\n    const repoUrlValue = repoUrl.value.trim();\n    const defaultRefValue = defaultRef.value.trim();\n    \n    // Step 1: Queue the job\n    statusMessage.value = 'Queueing repository initialization...';\n    const response = await reposAdd(repoUrlValue, defaultRefValue);\n    \n    console.log('[AddRepoModal] reposAdd response:', response);\n    console.log('[AddRepoModal] operation_id:', response?.operation_id);\n    \n    // Step 2: If we got an operation_id, wait for the background job to complete\n    if (response?.operation_id) {\n      console.log(`[AddRepoModal] Polling operation ${response.operation_id}...`);\n      \n      // Poll with status updates\n      await pollOperation(\n        response.operation_id, \n        60, \n        1000,\n        (status) => {\n          // Update modal message based on operation status\n          if (status.message) {\n            statusMessage.value = status.message;\n          } else if (status.status === 'queued') {\n            statusMessage.value = 'Waiting for job to start...';\n          } else if (status.status === 'running') {\n            statusMessage.value = `Initializing repository... (${status.progress || 0}%)`;\n          }\n        }\n      );\n      \n      console.log('[AddRepoModal] Operation completed successfully');\n      statusMessage.value = 'Repository initialized successfully!';\n    } else {\n      // Repo already existed\n      console.log('[AddRepoModal] No operation_id, repo may already exist');\n      statusMessage.value = 'Repository already exists';\n    }\n    \n    // Step 3: Notify parent that everything is ready\n    emit('added', {\n      repoUrl: repoUrlValue,\n      operationId: response?.operation_id || null\n    });\n    \n    // Close after a brief moment to show success message\n    await new Promise(resolve => setTimeout(resolve, 500));\n    onCancel();\n  } catch (e) {\n    console.error('[AddRepoModal] Error adding repo:', e);\n    error.value = e instanceof Error ? e.message : String(e);\n    statusMessage.value = '';\n  } finally {\n    busy.value = false;\n  }\n}\n\nfunction onCancel() {\n  repoUrl.value = '';\n  defaultRef.value = 'main';\n  urlError.value = '';\n  error.value = '';\n  statusMessage.value = '';\n  isOpen.value = false;\n}\n\n// Helper for i18n\nfunction $t(key) {\n  return mw.msg(key);\n}\n</script>\n\n<style scoped>\n.add-repo-form {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.error {\n  color: #d33;\n}\n</style>\n\n","<template>\n  <cdx-dialog\n    v-model:open=\"isOpen\"\n    :title=\"$t('labkipackmanager-add-ref-title')\"\n    :primary-action=\"{\n      label: $t('labkipackmanager-add-ref-submit'),\n      actionType: 'progressive',\n      disabled: busy || !isValid\n    }\"\n    :default-action=\"{\n      label: $t('labkipackmanager-cancel')\n    }\"\n    @primary=\"onSubmit\"\n    @default=\"onCancel\"\n  >\n    <div class=\"add-ref-form\">\n      <p class=\"repo-info\">\n        <strong>{{ $t('labkipackmanager-repository') }}:</strong> {{ repoUrl }}\n      </p>\n\n      <cdx-field\n        :is-fieldset=\"false\"\n      >\n        <template #label>{{ $t('labkipackmanager-ref-name-label') }}</template>\n        <cdx-text-input\n          v-model=\"refName\"\n          :placeholder=\"$t('labkipackmanager-ref-name-placeholder')\"\n          :disabled=\"busy\"\n        />\n      </cdx-field>\n\n      <cdx-message\n        v-if=\"statusMessage && !error\"\n        type=\"notice\"\n        :inline=\"true\"\n      >\n        {{ statusMessage }}\n      </cdx-message>\n\n      <cdx-message\n        v-if=\"error\"\n        type=\"error\"\n        :inline=\"true\"\n      >\n        {{ error }}\n      </cdx-message>\n    </div>\n  </cdx-dialog>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue';\nimport { CdxDialog, CdxField, CdxTextInput, CdxMessage } from '@wikimedia/codex';\nimport { reposAdd, pollOperation } from '../api/endpoints';\n\nconst props = defineProps({\n  modelValue: Boolean,\n  repoUrl: String\n});\n\nconst emit = defineEmits(['update:modelValue', 'added']);\n\nconst isOpen = computed({\n  get: () => props.modelValue,\n  set: (value) => emit('update:modelValue', value)\n});\n\nconst refName = ref('');\nconst error = ref('');\nconst busy = ref(false);\nconst statusMessage = ref('');\n\nconst isValid = computed(() => {\n  return refName.value.trim() !== '';\n});\n\nasync function onSubmit() {\n  if (!isValid.value || busy.value) {\n    return;\n  }\n\n  busy.value = true;\n  error.value = '';\n\n  try {\n    const refNameValue = refName.value.trim();\n    \n    // Step 1: Queue the job\n    statusMessage.value = 'Queueing ref initialization...';\n    const response = await reposAdd(props.repoUrl, refNameValue);\n    \n    console.log('[AddRefModal] reposAdd response:', response);\n    console.log('[AddRefModal] Response keys:', Object.keys(response || {}));\n    console.log('[AddRefModal] operation_id:', response?.operation_id);\n    console.log('[AddRefModal] labkiReposAdd:', response?.labkiReposAdd);\n    \n    // Step 2: If we got an operation_id, wait for the background job to complete\n    if (response?.operation_id) {\n      console.log(`[AddRefModal] Polling operation ${response.operation_id}...`);\n      \n      // Poll with status updates\n      await pollOperation(\n        response.operation_id, \n        60, \n        1000,\n        (status) => {\n          // Update modal message based on operation status\n          if (status.message) {\n            statusMessage.value = status.message;\n          } else if (status.status === 'queued') {\n            statusMessage.value = 'Waiting for job to start...';\n          } else if (status.status === 'running') {\n            statusMessage.value = `Creating worktree... (${status.progress || 0}%)`;\n          }\n        }\n      );\n      \n      console.log('[AddRefModal] Operation completed successfully');\n      statusMessage.value = 'Ref initialized successfully!';\n    } else {\n      // Ref already existed\n      console.log('[AddRefModal] No operation_id, ref may already exist');\n      statusMessage.value = 'Ref already exists';\n    }\n    \n    // Step 3: Notify parent that everything is ready\n    emit('added', {\n      refName: refNameValue,\n      operationId: response?.operation_id || null\n    });\n    \n    // Close after a brief moment to show success message\n    await new Promise(resolve => setTimeout(resolve, 500));\n    onCancel();\n  } catch (e) {\n    console.error('[AddRefModal] Error adding ref:', e);\n    error.value = e instanceof Error ? e.message : String(e);\n    statusMessage.value = '';\n  } finally {\n    busy.value = false;\n  }\n}\n\nfunction onCancel() {\n  refName.value = '';\n  error.value = '';\n  statusMessage.value = '';\n  isOpen.value = false;\n}\n\n// Helper for i18n\nfunction $t(key) {\n  return mw.msg(key);\n}\n</script>\n\n<style scoped>\n.add-ref-form {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.repo-info {\n  padding: 8px 12px;\n  background: #f8f9fa;\n  border-radius: 4px;\n  margin: 0;\n}\n</style>\n\n","<template>\n  <div class=\"repo-ref-selector\">\n    <h2>{{ $t('labkipackmanager-select-source') }}</h2>\n    \n    <div class=\"selector-row\" style=\"display: flex; gap: 24px; flex-wrap: nowrap;\">\n      <div class=\"selector-field\" style=\"flex: 1 1 0; min-width: 0;\">\n        <cdx-field>\n          <template #label>{{ $t('labkipackmanager-repo-selector-label') }}</template>\n          <cdx-select\n            v-model:selected=\"selectedRepoUrl\"\n            :menu-items=\"repoMenuItems\"\n            :disabled=\"store.busy\"\n            @update:selected=\"onRepoSelected\"\n          />\n        </cdx-field>\n      </div>\n      \n      <div class=\"selector-field\" style=\"flex: 1 1 0; min-width: 0;\">\n        <cdx-field>\n          <template #label>{{ $t('labkipackmanager-ref-selector-label') }}</template>\n          <cdx-select\n            v-model:selected=\"selectedRefName\"\n            :menu-items=\"refMenuItems\"\n            :disabled=\"store.busy || !selectedRepoUrl\"\n            @update:selected=\"onRefSelected\"\n          />\n        </cdx-field>\n      </div>\n    </div>\n    \n    <div v-if=\"selectedRepoUrl && selectedRefName\" class=\"current-selection\">\n      <strong>{{ $t('labkipackmanager-current-selection') }}:</strong>\n      {{ selectedRepoUrl }} @ {{ selectedRefName }}\n    </div>\n    \n    <cdx-message v-if=\"error\" type=\"error\" :inline=\"true\">\n      {{ error }}\n    </cdx-message>\n    \n    <add-repo-modal\n      v-model=\"showAddRepoModal\"\n      @added=\"onRepoAdded\"\n    />\n    \n    <add-ref-modal\n      v-model=\"showAddRefModal\"\n      :repo-url=\"selectedRepoUrl\"\n      @added=\"onRefAdded\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue';\nimport { CdxField, CdxSelect, CdxMessage } from '@wikimedia/codex';\nimport { store } from '../state/store';\nimport { reposList, graphGet, hierarchyGet, packsAction, pollOperation } from '../api/endpoints';\nimport AddRepoModal from './AddRepoModal.vue';\nimport AddRefModal from './AddRefModal.vue';\n\nconst ADD_REPO_VALUE = '__add_new_repo__';\nconst ADD_REF_VALUE = '__add_new_ref__';\n\nconst selectedRepoUrl = ref('');\nconst selectedRefName = ref('');\nconst showAddRepoModal = ref(false);\nconst showAddRefModal = ref(false);\nconst error = ref('');\n\nconst repoMenuItems = computed(()  => {\n  console.log('Computing repoMenuItems, store.repos:', store.repos);\n  \n  if (!store.repos || store.repos.length === 0) {\n    return [{\n      label: 'Loading...',\n      value: '',\n      disabled: true\n    }];\n  }\n  \n  const items = store.repos.map(repo => ({\n    label: repo.repo_url,\n    value: repo.repo_url,\n  }));\n  \n  // Add separator and \"Add new\" option\n  items.push({\n    label: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n    value: '__separator__',\n    disabled: true,\n  });\n  items.push({\n    label: $t('labkipackmanager-add-repo-option'),\n    value: ADD_REPO_VALUE,\n  });\n  \n  return items;\n});\n\nconst refMenuItems = computed(()  => {\n  if (!store.selectedRepo) {\n    return [];\n  }\n  \n  const items = store.selectedRepo.refs.map(ref => ({\n    label: `${ref.ref_name} ${ref.is_default ? '(default)' : ''}`,\n    value: ref.ref,\n  }));\n  \n  // Add separator and \"Add new\" option\n  items.push({\n    label: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n    value: '__separator__',\n    disabled: true,\n  });\n  items.push({\n    label: $t('labkipackmanager-add-ref-option'),\n    value: ADD_REF_VALUE,\n  });\n  \n  return items;\n});\n\nonMounted(async () => {\n  console.log('RepoRefSelector mounted, store:', store);\n  await loadRepos();\n});\n\nasync function loadRepos() {\n  try {\n    console.log('[loadRepos] Starting...');\n    store.busy = true;\n    error.value = '';\n    console.log('[loadRepos] Calling reposList API...');\n    const response = await reposList();\n    console.log('[loadRepos] API response received:', response);\n    \n    if (!response) {\n      throw new Error('No response from reposList API');\n    }\n    \n    if (!response.repos) {\n      throw new Error('Invalid response structure - no repos field. Response: ' + JSON.stringify(response));\n    }\n    \n    console.log('[loadRepos] Setting store.repos:', response.repos);\n    store.repos = response.repos;\n    console.log('[loadRepos] store.repos is now:', store.repos);\n    console.log('[loadRepos] store.repos.length:', store.repos.length);\n    \n    // Auto-select first repo if available\n    if (store.repos.length > 0 && !selectedRepoUrl.value) {\n      console.log('[loadRepos] Auto-selecting first repo:', store.repos[0].repo_url);\n      await selectRepo(store.repos[0].repo_url);\n    }\n  } catch (e) {\n    console.error('[loadRepos] Error:', e);\n    error.value = e instanceof Error ? e.message : String(e);\n  } finally {\n    store.busy = false;\n    console.log('[loadRepos] Finished. store.busy:', store.busy, 'store.repos:', store.repos);\n  }\n}\n\nasync function onRepoSelected(value) {\n  if (value === ADD_REPO_VALUE) {\n    showAddRepoModal.value = true;\n    // Reset selection\n    selectedRepoUrl.value = store.repoUrl;\n    return;\n  }\n  \n  if (typeof value === 'string' && value && value !== '__separator__') {\n    await selectRepo(value);\n  }\n}\n\nasync function selectRepo(url) {\n  try {\n    store.busy = true;\n    error.value = '';\n    \n    selectedRepoUrl.value = url;\n    store.repoUrl = url;\n    \n    // Find repo object\n    const repo = store.repos.find(r => r.repo_url === url);\n    if (!repo) {\n      throw new Error($t('labkipackmanager-error-repo-not-found'));\n    }\n    \n    store.selectedRepo = repo;\n    \n    // Auto-select default ref\n    const defaultRefObj = repo.refs.find(r => r.is_default);\n    const defaultRef = defaultRefObj?.ref || repo.refs[0]?.ref;\n    \n    if (defaultRef) {\n      await selectRef(defaultRef);\n    }\n  } catch (e) {\n    error.value = e instanceof Error ? e.message : String(e);\n  } finally {\n    store.busy = false;\n  }\n}\n\nasync function onRefSelected(value) {\n  if (value === ADD_REF_VALUE) {\n    showAddRefModal.value = true;\n    // Reset selection\n    selectedRefName.value = store.ref;\n    return;\n  }\n  \n  if (typeof value === 'string' && value && value !== '__separator__') {\n    await selectRef(value);\n  }\n}\n\nasync function selectRef(refName) {\n  try {\n    store.busy = true;\n    error.value = '';\n    \n    selectedRefName.value = refName;\n    store.ref = refName;\n    \n    // IMPORTANT: Reset packs state before init\n    // The init command on backend returns full state, and frontend must start empty\n    store.packs = {};\n    store.warnings = [];\n    \n    // Fetch graph and hierarchy\n    const [graphResponse, hierarchyResponse] = await Promise.all([\n      graphGet(store.repoUrl, store.ref),\n      hierarchyGet(store.repoUrl, store.ref),\n    ]);\n    \n    // Build mermaid source from graph\n    store.mermaidSrc = buildMermaidFromGraph(graphResponse.graph);\n    store.hierarchy = hierarchyResponse.hierarchy;\n    \n    // Initialize pack state\n    const initResponse = await packsAction({\n      command: 'init',\n      repo_url: store.repoUrl,\n      ref: store.ref,\n      data: {},\n    });\n    \n    // On init, diff contains full state\n    store.packs = initResponse.diff;\n    store.stateHash = initResponse.state_hash;\n    store.warnings = initResponse.warnings;\n  } catch (e) {\n    error.value = e instanceof Error ? e.message : String(e);\n  } finally {\n    store.busy = false;\n  }\n}\n\nasync function onRepoAdded(eventData) {\n  // The repo was added and the modal already waited for completion\n  // Now we just need to reload and select it\n  try {\n    store.busy = true;\n    error.value = '';\n    \n    const { repoUrl } = eventData;\n    \n    console.log(`[onRepoAdded] Repo '${repoUrl}' initialized, reloading repos and selecting...`);\n    \n    // Reload repos to get the updated repo list\n    await loadRepos();\n    \n    // Select the newly added repo\n    await selectRepo(repoUrl);\n    \n    console.log('[onRepoAdded] Repo selected successfully');\n    \n  } catch (e) {\n    console.error('[onRepoAdded] Error:', e);\n    error.value = e instanceof Error ? e.message : String(e);\n  } finally {\n    store.busy = false;\n  }\n}\n\nasync function onRefAdded(eventData) {\n  // The ref was added and the modal already waited for completion\n  // Now we just need to reload and select it\n  try {\n    store.busy = true;\n    error.value = '';\n    \n    const { refName } = eventData;\n    \n    console.log(`[onRefAdded] Ref '${refName}' initialized, reloading repos and selecting...`);\n    \n    // Reload repos to get the updated ref list\n    await loadRepos();\n    \n    // Re-select the current repo to refresh store.selectedRepo with the new ref\n    // This is needed because store.selectedRepo still points to the old repo object\n    if (selectedRepoUrl.value) {\n      await selectRepo(selectedRepoUrl.value);\n    }\n    \n    // Select the newly added ref\n    await selectRef(refName);\n    \n    console.log('[onRefAdded] Ref selected successfully');\n    \n  } catch (e) {\n    console.error('[onRefAdded] Error:', e);\n    error.value = e instanceof Error ? e.message : String(e);\n  } finally {\n    store.busy = false;\n  }\n}\n\nfunction buildMermaidFromGraph(graph) {\n  const lines = ['graph TD'];\n  \n  // Create node definitions first\n  const nodes = new Set();\n  const edges = [];\n  \n  // Collect all nodes from edges\n  for (const edge of graph.containsEdges || []) {\n    nodes.add(edge.from);\n    nodes.add(edge.to);\n    edges.push({ from: edge.from, to: edge.to, type: 'contains' });\n  }\n  \n  for (const edge of graph.dependsEdges || []) {\n    nodes.add(edge.from);\n    nodes.add(edge.to);\n    edges.push({ from: edge.from, to: edge.to, type: 'depends' });\n  }\n  \n  // Add node definitions with labels\n  // Backend now provides prefixed names like \"pack:People\" and \"page:People\"\n  for (const node of nodes) {\n    const nodeId = escapeNodeName(node);\n    // Extract the display name and icon from the prefixed node name\n    const [prefix, ...nameParts] = node.split(':');\n    const displayName = nameParts.join(':'); // rejoin in case name has colons\n    const icon = prefix === 'page' ? 'üìÑ' : 'üì¶';\n    lines.push(`  ${nodeId}[\"${icon} ${displayName}\"]`);\n  }\n  \n  // Add edges\n  for (const edge of edges) {\n    const fromNode = escapeNodeName(edge.from);\n    const toNode = escapeNodeName(edge.to);\n    if (edge.type === 'depends') {\n      lines.push(`  ${fromNode} -.-> ${toNode}`);\n    } else {\n      lines.push(`  ${fromNode} --> ${toNode}`);\n    }\n  }\n  \n  const mermaidSrc = lines.join('\\n');\n  console.log('[buildMermaidFromGraph] Generated Mermaid syntax:\\n', mermaidSrc);\n  return mermaidSrc;\n}\n\nfunction escapeNodeName(name) {\n  // Replace spaces and special chars with underscores\n  return name.replace(/[^a-zA-Z0-9_]/g, '_');\n}\n\n// Helper for i18n\nfunction $t(key) {\n  return mw.msg(key);\n}\n</script>\n\n<style scoped>\n.repo-ref-selector {\n  padding: 20px;\n  background: white;\n  border: 1px solid #c8ccd1;\n  border-radius: 8px;\n  margin-bottom: 20px;\n}\n\nh2 {\n  margin-top: 0;\n  margin-bottom: 16px;\n  font-size: 1.4em;\n}\n\n.selector-row {\n  display: flex !important;\n  flex-wrap: nowrap !important;\n  gap: 24px;\n  align-items: flex-start;\n  width: 100%;\n}\n\n.selector-field {\n  flex: 1 1 0 !important;\n  min-width: 0 !important;\n  width: auto !important;\n}\n\n/* Make the cdx-field fill its wrapper but not force line breaks */\n.selector-field :deep(.cdx-field) {\n  width: 100% !important;\n  margin: 0 !important;\n  display: block !important;\n}\n\n.current-selection {\n  padding: 12px;\n  background: #eaf3ff;\n  border-radius: 4px;\n  font-size: 0.95em;\n  margin-bottom: 16px;\n}\n\n@media (max-width: 768px) {\n  .selector-row {\n    flex-direction: column;\n  }\n}\n</style>\n","<template>\n  <div class=\"mermaid-graph-container\">\n    <h3>{{ $t('labkipackmanager-graph-title') }}</h3>\n    \n    <div v-if=\"!hasMermaid\" class=\"no-mermaid-message\">\n      <cdx-message type=\"warning\" :inline=\"true\">\n        {{ $t('labkipackmanager-mermaid-not-installed') }}\n      </cdx-message>\n    </div>\n    \n    <div v-else-if=\"mermaidSrc\" class=\"mermaid-wrapper\">\n      <pre class=\"mermaid\" ref=\"mermaidPre\">{{ mermaidSrc }}</pre>\n    </div>\n    \n    <div v-else class=\"no-graph-message\">\n      <p>{{ $t('labkipackmanager-no-graph-loaded') }}</p>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, watch, nextTick } from 'vue';\nimport { CdxMessage } from '@wikimedia/codex';\n\nconst props = defineProps({\n  mermaidSrc: String\n});\n\nconst hasMermaid = ref(false);\nconst mermaidPre = ref(null);\n\nonMounted(() => {\n  checkMermaidAvailability();\n});\n\nwatch(() => props.mermaidSrc, async () => {\n  if (hasMermaid.value && props.mermaidSrc) {\n    // Wait for Vue to update the DOM\n    await nextTick();\n    // Then trigger Mermaid to render the new content\n    triggerMermaidRender();\n  }\n});\n\nfunction checkMermaidAvailability() {\n  // Check if Mermaid extension module is available\n  const state = mw.loader.getState('ext.mermaid');\n  hasMermaid.value = state === 'ready' || state === 'loaded' || state === 'loading';\n  \n  if (!hasMermaid.value) {\n    console.warn('Mermaid extension is not available');\n  } else {\n    console.log('[MermaidGraph] Mermaid extension is available, state:', state);\n  }\n}\n\nfunction triggerMermaidRender() {\n  console.log('[MermaidGraph] Triggering Mermaid render');\n  \n  // Try to access the mermaid global if available\n  if (typeof window !== 'undefined' && window.mermaid) {\n    try {\n      // First, try to initialize/reset mermaid state\n      if (typeof window.mermaid.initialize === 'function') {\n        console.log('[MermaidGraph] Calling mermaid.initialize()');\n        window.mermaid.initialize({ \n          startOnLoad: false,\n          theme: 'forest',\n          securityLevel: 'loose'\n        });\n      }\n      \n      // Remove any previously rendered SVG inside the pre element\n      if (mermaidPre.value) {\n        const svgs = mermaidPre.value.querySelectorAll('svg');\n        svgs.forEach(svg => svg.remove());\n        console.log('[MermaidGraph] Removed', svgs.length, 'existing SVG(s)');\n        \n        // Reset the pre element's HTML to just the text (remove any data attributes mermaid added)\n        mermaidPre.value.innerHTML = props.mermaidSrc;\n        mermaidPre.value.removeAttribute('data-processed');\n      }\n      \n      // Add a small delay to ensure DOM has fully updated\n      setTimeout(() => {\n        console.log('[MermaidGraph] Attempting to render mermaid diagrams');\n        \n        // Try different methods to trigger rendering\n        if (typeof window.mermaid.run === 'function') {\n          window.mermaid.run();\n          console.log('[MermaidGraph] Called mermaid.run()');\n        } else if (typeof window.mermaid.contentLoaded === 'function') {\n          window.mermaid.contentLoaded();\n          console.log('[MermaidGraph] Called mermaid.contentLoaded()');\n        }\n      }, 100);\n    } catch (e) {\n      console.error('[MermaidGraph] Failed to trigger mermaid render:', e);\n    }\n  } else {\n    console.warn('[MermaidGraph] window.mermaid not available');\n  }\n}\n\n// Helper for i18n\nfunction $t(key) {\n  return mw.msg(key);\n}\n</script>\n\n<style scoped>\n.mermaid-graph-container {\n  margin: 20px 0;\n  padding: 20px;\n  background: #f8f9fa;\n  border-radius: 8px;\n}\n\nh3 {\n  margin-top: 0;\n  margin-bottom: 16px;\n  font-size: 1.2em;\n}\n\n.no-mermaid-message,\n.no-graph-message {\n  padding: 16px;\n  text-align: center;\n}\n\n.no-graph-message p {\n  margin: 0;\n  color: #72777d;\n}\n\n.ext-mermaid {\n  margin: 16px 0;\n  min-height: 200px;\n}\n</style>\n\n",null,"<template>\n  <!--\n    ============================================================================\n    TREE NODE LAYOUT - CARD-BASED NESTING WITH INLINE STYLES\n    ============================================================================\n    \n    üéØ CRITICAL SUCCESS FACTORS - WHY THIS WORKS:\n    \n    1. **INLINE STYLES ARE REQUIRED** - CSS classes were NOT working due to:\n       - MediaWiki/Codex CSS has extremely high specificity\n       - External stylesheets were being overridden\n       - Inline styles have highest specificity and can't be overridden\n       - ‚úÖ Use :style=\"\" binding in template for all visual styling\n       - ‚ùå DO NOT rely on CSS classes alone for layout/colors\n    \n    2. **CHILDREN MUST BE INSIDE PACK-CARD** - This creates true nesting:\n       - The .pack-card div wraps the entire pack (row + meta + children)\n       - Children render INSIDE their parent's card, not as siblings\n       - This creates the \"recursive card nesting\" visual effect\n       - Each nested pack gets its own card INSIDE the parent card\n    \n    3. **INDENTATION** - Applied via inline paddingLeft on .node-row:\n       - Formula: `paddingLeft: ${depth * 24}px`\n       - depth=0: 0px, depth=1: 24px, depth=2: 48px, etc.\n       - Applied to .node-row, NOT the .pack-card wrapper\n    \n    4. **COLOR CODING** - Inline background colors based on state:\n       - Installed: #e8f0f8 (blue)\n       - Install action: #e8f5e9 (green)\n       - Remove action: #ffebee (red)\n       - Update action: #fff8e1 (yellow)\n       - Default: #ffffff (white)\n    \n    5. **VISUAL HIERARCHY**:\n       - Border: 2px solid creates clear card boundaries\n       - Border-radius: 8px for rounded corners\n       - Box-shadow: 0 2px 4px rgba() for depth\n       - Padding: 12px inside cards for breathing room\n       - Margin-bottom: 12px between cards\n    \n    ‚ö†Ô∏è MAINTENANCE NOTES:\n    - If visual changes don't appear, check if inline styles are present\n    - CSS classes are kept for semantic purposes but don't control layout\n    - Any layout-critical styling MUST be in :style=\"\" bindings\n    - Test changes by checking if inline styles render in browser DevTools\n    \n    ============================================================================\n  -->\n  <div\n    class=\"tree-node\"\n    :class=\"{ 'is-pack': node.type === 'pack', 'is-page': node.type === 'page' }\"\n    :data-type=\"node.type\"\n    :data-action=\"packState?.action || pageParentAction\"\n    :data-installed=\"node.type === 'pack' ? packState?.installed : pageState?.installed\"\n  >\n      <!-- \n        PACK CARD WRAPPER - Creates rounded rectangle container\n        ‚ö†Ô∏è INLINE STYLES REQUIRED: CSS classes don't work due to MW/Codex specificity\n        - Border creates card boundary\n        - Background color shows state: blue=installed, green=install, red=remove, yellow=update\n        - Children render INSIDE this div for proper nesting\n      -->\n      <div \n        v-if=\"node.type === 'pack'\" \n        class=\"pack-card\" \n        :data-depth=\"depth\"\n        :style=\"{\n          border: '2px solid #c8ccd1',           /* Card boundary */\n          borderRadius: '8px',                   /* Rounded corners */\n          padding: '10px',                       /* Breathing room inside card */\n          marginBottom: '8px',                   /* Space between cards */\n          background: packState?.installed ? '#e8f0f8' :        /* Blue = installed */\n                      packState?.action === 'install' ? '#e8f5e9' :  /* Green = install */\n                      packState?.action === 'remove' ? '#ffebee' :   /* Red = remove */\n                      packState?.action === 'update' ? '#fff8e1' :   /* Yellow = update */\n                      '#ffffff',                                      /* White = default */\n          boxShadow: '0 2px 4px rgba(0,0,0,0.1)' /* Depth/elevation effect */\n        }\"\n      >\n        <!-- \n          TWO-COLUMN LAYOUT: Pack info on left, Pages on right\n          ‚ö†Ô∏è Main content area splits into left (pack) and right (pages)\n        -->\n        <div class=\"pack-content-wrapper\" :style=\"{\n          display: 'flex',\n          gap: '12px',\n          alignItems: 'flex-start'\n        }\">\n          <!-- LEFT COLUMN: Pack info and actions -->\n          <div class=\"pack-info-column\" :style=\"{\n            flex: childPages.length > 0 ? '0 1 auto' : '1',\n            minWidth: '0',\n            display: 'flex',\n            flexDirection: 'column',\n            gap: '8px'\n          }\">\n            <!-- Pack header row -->\n            <div class=\"node-row\" :style=\"{ \n              paddingLeft: `${depth * 24}px`,\n              display: 'flex',\n              alignItems: 'center',\n              gap: '8px',\n              flexWrap: 'nowrap'\n            }\">\n              <!-- Toggle arrow -->\n              <button\n                v-if=\"childPacks.length > 0\"\n                class=\"toggle\"\n                :aria-expanded=\"expanded.toString()\"\n                :aria-label=\"expanded ? $t('labkipackmanager-collapse') : $t('labkipackmanager-expand')\"\n                @click=\"toggleExpanded\"\n              >\n                {{ expanded ? '‚ñº' : '‚ñ∂' }}\n              </button>\n              <span v-else class=\"toggle-spacer\"></span>\n\n              <!-- Icon -->\n              <span class=\"node-icon\">üì¶</span>\n              \n              <!-- Name and badges -->\n              <span class=\"name-section\">\n                <strong class=\"label\" :title=\"node.label\">{{ node.label }}</strong>\n                \n                <span v-if=\"node.version\" class=\"badge version\">v{{ node.version }}</span>\n                \n                <span\n                  v-if=\"packState && packState.action && packState.action !== 'unchanged'\"\n                  class=\"badge\"\n                  :class=\"packState.auto_selected_reason ? 'auto' : 'manual'\"\n                  :title=\"packState.auto_selected_reason || ''\"\n                >\n                  {{ packState.auto_selected_reason ? 'Auto' : 'Manual' }}\n                </span>\n                \n                <span v-if=\"canUpdate\" class=\"badge update\">Update Available</span>\n              </span>\n            </div>\n            \n            <!-- Pack: Inline prefix editor (on second row) -->\n            <div v-if=\"showPackEditor\" :style=\"{ \n              paddingLeft: `${depth * 24 + 32}px`,\n              display: 'flex',\n              alignItems: 'center',\n              gap: '6px'\n            }\">\n              <span class=\"prefix-label\" :style=\"{ fontSize: '0.75em', color: '#72777d', fontWeight: '600' }\">Prefix:</span>\n              <input\n                class=\"prefix-input\"\n                type=\"text\"\n                :value=\"prefixInputValue\"\n                :placeholder=\"$t('labkipackmanager-pack-prefix-placeholder') || 'MyNamespace/MyPack'\"\n                :disabled=\"!isPackEditable\"\n                :readonly=\"!isPackEditable\"\n                @input=\"onPrefixChange\"\n                :style=\"{\n                  fontSize: '0.72em',\n                  padding: '4px 7px',\n                  minWidth: '150px',\n                  border: '1px solid #c8ccd1',\n                  borderRadius: '3px',\n                  background: 'white',\n                  fontFamily: 'Monaco, Menlo, Consolas, monospace',\n                  transition: 'all 0.15s ease',\n                  cursor: isPackEditable ? 'text' : 'not-allowed'\n                }\"\n              />\n            </div>\n\n            <!-- Actions (for packs only) - on third row -->\n            <div class=\"actions\" :style=\"{\n              paddingLeft: `${depth * 24 + 32}px`,\n              display: 'flex',\n              gap: '8px',\n              flexWrap: 'wrap'\n            }\">\n              <div class=\"action-item\" v-if=\"packState && packState.current_version === null\">\n                <cdx-button\n                  action=\"progressive\"\n                  :weight=\"packState.action === 'install' ? 'primary' : 'normal'\"\n                  :class=\"{ active: packState.action === 'install' }\"\n                  @click=\"toggleInstall\"\n                >\n                  {{ packState.action === 'install' ? '‚úì ' : '' }}{{ $t('labkipackmanager-select') }}\n                </cdx-button>\n              </div>\n\n              <div class=\"action-item\" v-if=\"canUpdate\">\n                <cdx-button\n                  :weight=\"packState?.action === 'update' ? 'primary' : 'normal'\"\n                  :class=\"{ active: packState?.action === 'update' }\"\n                  @click=\"toggleUpdate\"\n                >\n                  {{ packState?.action === 'update' ? '‚úì ' : '' }}{{ $t('labkipackmanager-update') }}\n                </cdx-button>\n              </div>\n\n              <div class=\"action-item\" v-if=\"packState && packState.current_version !== null\">\n                <cdx-button\n                  action=\"destructive\"\n                  :weight=\"packState.action === 'remove' ? 'primary' : 'normal'\"\n                  :class=\"{ active: packState.action === 'remove' }\"\n                  @click=\"toggleRemove\"\n                >\n                  {{ packState.action === 'remove' ? '‚úì ' : '' }}{{ $t('labkipackmanager-remove') }}\n                </cdx-button>\n              </div>\n            </div>\n          </div>\n          \n          <!-- RIGHT COLUMN: Pages list (if any) -->\n          <div v-if=\"childPages.length > 0\" class=\"pages-column\" :style=\"{\n            flex: '1',\n            minWidth: '250px',\n            maxWidth: '400px',\n            display: 'flex',\n            flexDirection: 'column',\n            gap: '4px',\n            padding: '6px',\n            background: 'rgba(248, 249, 250, 0.3)',\n            borderRadius: '6px',\n            border: '1px solid #eaecf0'\n          }\">\n            <div :style=\"{ \n              fontSize: '0.7em', \n              color: '#72777d', \n              fontWeight: '700',\n              textTransform: 'uppercase',\n              letterSpacing: '0.5px',\n              marginBottom: '2px',\n              paddingLeft: '4px'\n            }\">\n              üìÑ Pages ({{ childPages.length }})\n            </div>\n            \n            <!-- Each page as a row with rename input -->\n            <div \n              v-for=\"page in childPages\"\n              :key=\"page.id\"\n              class=\"page-row-inline\"\n              :style=\"{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '6px',\n                padding: '4px 6px',\n                background: getPageBackground(page.label),\n                borderRadius: '4px',\n                border: '1px solid #eaecf0',\n                minHeight: '32px'\n              }\"\n            >\n              <span :style=\"{ \n                fontSize: '0.8em', \n                color: '#202122',\n                fontWeight: '500',\n                minWidth: '60px',\n                maxWidth: '80px',\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                whiteSpace: 'nowrap'\n              }\" :title=\"page.label\">{{ page.label }}</span>\n              \n              <!-- Page rename editor (show if pack is selected for install/update or installed) -->\n              <span v-if=\"showPackEditor\" class=\"page-rename-inline\" :style=\"{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '3px',\n                flex: '1',\n                minWidth: '0'\n              }\">\n                <span class=\"arrow\" :style=\"{ color: '#72777d', fontSize: '0.8em' }\">‚Üí</span>\n                <span v-if=\"getDisplayPrefix(page.label)\" class=\"prefix-chip-inline\" :style=\"{\n                  fontSize: '0.7em',\n                  padding: '3px 6px',\n                  background: '#f0f0f0',\n                  border: '1px solid #c8ccd1',\n                  borderRight: 'none',\n                  borderRadius: '3px 0 0 3px',\n                  color: '#54595d',\n                  whiteSpace: 'nowrap',\n                  fontFamily: 'Monaco, Menlo, Consolas, monospace'\n                }\">{{ getDisplayPrefixWithSlash(page.label) }}</span>\n                <input\n                  class=\"page-input\"\n                  :class=\"{ 'has-collision': getPageHasCollision(page.label) }\"\n                  type=\"text\"\n                  :value=\"getPageEditableTitle(page.label)\"\n                  :placeholder=\"$t('labkipackmanager-page-title-placeholder') || 'PageTitle'\"\n                  :disabled=\"!getPageEditable(page.label)\"\n                  :readonly=\"!getPageEditable(page.label)\"\n                  @input=\"(e) => onPageTitleChangeForPage(e, page.label)\"\n                  @focus=\"() => console.log('[Page Input Focus] Page:', page.label, 'Editable:', getPageEditable(page.label), 'Pack action:', packState?.action)\"\n                  :aria-invalid=\"getPageHasCollision(page.label) ? 'true' : 'false'\"\n                  :style=\"{\n                    fontSize: '0.72em',\n                    padding: '4px 7px',\n                    flex: '1',\n                    minWidth: '100px',\n                    border: getPageHasCollision(page.label) ? '1px solid #d33' : '1px solid #c8ccd1',\n                    borderRadius: getDisplayPrefix(page.label) ? '0 3px 3px 0' : '3px',\n                    background: getPageHasCollision(page.label) ? '#fff5f5' : 'white',\n                    fontFamily: 'Monaco, Menlo, Consolas, monospace',\n                    transition: 'all 0.15s ease',\n                    cursor: getPageEditable(page.label) ? 'text' : 'not-allowed'\n                  }\"\n                />\n                <span v-if=\"getPageHasCollision(page.label)\" class=\"collision-icon\" :style=\"{ \n                  fontSize: '1.1em', \n                  cursor: 'help',\n                  color: '#d33'\n                }\" :id=\"getCollisionId(page.label)\" :title=\"getCollisionTooltip(page.label)\">‚ö†Ô∏è</span>\n              </span>\n            </div>\n          </div>\n        </div>\n        \n        <!-- Description and dependencies below both columns -->\n        \n        <!-- Description and dependencies on second row if present -->\n        <div v-if=\"node.description || node.depends_on?.length\" class=\"meta-row\" :style=\"{\n          marginTop: '6px',\n          paddingLeft: '32px',\n          paddingTop: '6px',\n          borderTop: '1px solid #eaecf0'\n        }\">\n          <div class=\"meta-content\" :style=\"{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: '3px'\n          }\">\n            <div v-if=\"node.description\" class=\"desc\" :style=\"{\n              fontSize: '0.85em',\n              color: '#54595d',\n              lineHeight: '1.4'\n            }\">{{ node.description }}</div>\n            <div v-if=\"node.depends_on?.length\" class=\"depends\" :style=\"{\n              fontSize: '0.8em',\n              color: '#72777d'\n            }\">\n              <small>{{ $t('labkipackmanager-depends-on') }}: {{ node.depends_on.join(', ') }}</small>\n            </div>\n          </div>\n        </div>\n\n        <!-- \n          NESTED PACKS CONTAINER - Only renders nested PACKS (pages shown inline above)\n          ‚ö†Ô∏è This is what creates the \"recursive card nesting\" effect\n          - Children are inside the .pack-card div, not siblings\n          - Each child pack creates its own card, nested inside this one\n          - Visual indentation via left border + paddingLeft\n        -->\n        <transition\n          name=\"children\"\n          @enter=\"onChildrenEnter\"\n          @leave=\"onChildrenLeave\"\n        >\n          <div\n            v-if=\"expanded && childPacks.length > 0\"\n            class=\"children\"\n            :style=\"{\n              marginTop: '8px',             /* Space from parent content */\n              paddingLeft: '16px',          /* Indent nested items */\n              borderLeft: '2px solid #eaecf0',  /* Visual nesting indicator */\n              paddingTop: '4px'             /* Top spacing */\n            }\"\n          >\n            <tree-node\n              v-for=\"child in childPacks\"\n              :key=\"child.id\"\n              :node=\"child\"\n              :depth=\"depth + 1\"\n              :parent-pack-name=\"nodePackName\"\n              @set-pack-action=\"$emit('set-pack-action', $event)\"\n            />\n          </div>\n        </transition>\n      </div>\n\n      <!-- \n        PAGE ROW - Only rendered for standalone pages (not in a pack's children)\n        This handles edge case where pages might be at root level\n      -->\n      <div \n        v-else-if=\"node.type === 'page'\"\n        class=\"page-row\"\n        :style=\"{\n          padding: '8px 12px',\n          background: pageState?.installed ? 'rgba(232, 240, 248, 0.4)' :          /* Blue if installed */\n                      pageParentAction === 'install' ? 'rgba(232, 245, 233, 0.6)' : /* Green if installing */\n                      pageParentAction === 'remove' ? 'rgba(255, 235, 238, 0.6)' :  /* Red if removing */\n                      'rgba(255, 255, 255, 0.5)',                                    /* Transparent white */\n          borderRadius: '6px',      /* Slightly rounded */\n          marginBottom: '6px'       /* Space between pages */\n        }\"\n      >\n        <span class=\"toggle-spacer\"></span>\n        <span class=\"node-icon\">üìÑ</span>\n        <strong class=\"label\">{{ node.label }}</strong>\n        \n        <!-- Page rename editor -->\n        <span v-if=\"showPageEditor\" class=\"page-rename-inline\">\n          <span class=\"arrow\">‚Üí</span>\n          <span v-if=\"displayPrefix\" class=\"prefix-chip-inline\">{{ displayPrefixWithSlash }}</span>\n          <input\n            class=\"page-input\"\n            :class=\"{ 'has-collision': pageHasCollision }\"\n            type=\"text\"\n            :value=\"pageEditableTitle\"\n            :placeholder=\"$t('labkipackmanager-page-title-placeholder') || 'PageTitle'\"\n            :disabled=\"!isPageEditable\"\n            :readonly=\"!isPageEditable\"\n            @input=\"onPageTitleChange\"\n            :aria-invalid=\"pageHasCollision ? 'true' : 'false'\"\n            :aria-describedby=\"pageHasCollision ? collisionId : undefined\"\n          />\n          <span v-if=\"pageHasCollision\" class=\"collision-icon\" :id=\"collisionId\" :title=\"collisionTooltip\">‚ö†Ô∏è</span>\n        </span>\n      </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onBeforeUnmount, watch } from 'vue'\nimport { CdxButton } from '@wikimedia/codex'\nimport { store } from '../state/store'\nimport { packsAction } from '../api/endpoints'\nimport { mergeDiff } from '../state/merge'\n\nconst props = defineProps({\n  node: { type: Object, required: true },\n  depth: { type: Number, required: true },\n  parentPackName: { type: String, default: null },\n})\nconst emit = defineEmits(['set-pack-action'])\n\nconst expanded = ref(false)\nlet prefixTimer = null\nlet pageTimer = null\n\nconst hasChildren = computed(\n  () => !!(props.node.children && props.node.children.length)\n)\nconst packState = computed(() =>\n  props.node.type === 'pack' ? store.packs[props.node.label] || null : null\n)\nconst isPackSelected = computed(() => {\n  const action = packState.value?.action\n  return action && action !== 'unchanged'\n})\nconst isPackEditable = computed(() => {\n  const action = packState.value?.action\n  const installed = packState.value?.installed\n  return action === 'install' && !installed\n})\nconst showPackEditor = computed(() => {\n  const action = packState.value?.action\n  const installed = packState.value?.installed\n  return (action === 'install' || action === 'update') || installed\n})\nconst prefixInputValue = computed(() => packState.value?.prefix || '')\nconst nodePackName = computed(() =>\n  props.node.type === 'pack' ? props.node.label : null\n)\nconst parentName = computed(() =>\n  props.node.type === 'page' ? props.parentPackName || null : null\n)\nconst parentPackState = computed(() =>\n  parentName.value ? store.packs[parentName.value] || null : null\n)\nconst pageState = computed(() =>\n  parentPackState.value?.pages\n    ? parentPackState.value.pages[props.node.label] || null\n    : null\n)\nconst isPageParentSelected = computed(() => {\n  const action = parentPackState.value?.action\n  return action === 'install' || action === 'update'\n})\nconst isPageEditable = computed(() => {\n  // For pages in the right column, check the pack's state (this node is the pack)\n  if (props.node.type === 'pack') {\n    const action = packState.value?.action\n    return action === 'install' || action === 'update'\n  }\n  \n  // For standalone page nodes (legacy), check parent pack\n  const action = parentPackState.value?.action\n  const installed = pageState.value?.installed\n  return action === 'install' && !installed\n})\nconst showPageEditor = computed(() => {\n  const action = parentPackState.value?.action\n  const installed = pageState.value?.installed\n  return (action === 'install' || action === 'update') || installed\n})\nconst pageParentAction = computed(() => parentPackState.value?.action || 'unchanged')\nconst displayPrefix = computed(() => parentPackState.value?.prefix || '')\nconst displayPrefixWithSlash = computed(() =>\n  displayPrefix.value\n    ? displayPrefix.value.endsWith('/')\n      ? displayPrefix.value\n      : displayPrefix.value + '/'\n    : ''\n)\nconst pageEditableTitle = computed(() => {\n  const full = pageState.value?.final_title || ''\n  const pref = displayPrefixWithSlash.value\n  return pref && full.startsWith(pref) ? full.slice(pref.length) : full\n})\nconst pageHasCollision = computed(() => {\n  const full = pageState.value?.final_title\n  if (!full || !parentName.value) return false\n  return store.warnings.some(\n    (w) => w.includes(full) && w.includes(parentName.value)\n  )\n})\nconst collisionTooltip = computed(() => {\n  const full = pageState.value?.final_title\n  if (!full || !parentName.value) return ''\n  return store.warnings\n    .filter((w) => w.includes(full) && w.includes(parentName.value))\n    .join('\\n')\n})\nconst collisionId = computed(\n  () => `collision-${parentName.value || 'none'}-${props.node.label}`\n)\nconst canUpdate = computed(() => {\n  const ps = packState.value\n  if (!ps) return false\n  if (ps.current_version === null) return false\n  if (!ps.target_version) return false\n  return ps.target_version > ps.current_version\n})\n\nif (props.node.type === 'pack') {\n  watch(() => packState.value?.action, (newAction, oldAction) => {\n    console.log(`[TreeNode:${props.node.label}] packState.action changed: \"${oldAction}\" -> \"${newAction}\"`)\n  })\n}\n\nconst subtreeHasAction = computed(() => {\n  store.stateHash\n  const check = (n) => {\n    if (n.type === 'pack') {\n      const s = store.packs[n.label]\n      if (s && s.action && s.action !== 'unchanged') return true\n    }\n    if (!n.children) return false\n    for (const c of n.children) if (check(c)) return true\n    return false\n  }\n  return check(props.node)\n})\nexpanded.value = props.depth < 2 || subtreeHasAction.value\n\nfunction toggleExpanded() { expanded.value = !expanded.value }\n\nfunction toggleAction(action) {\n  const current = packState.value?.action\n  const next = current === action ? 'unchanged' : action\n  console.log(`[TreeNode:${props.node.label}] toggleAction: current=\"${current}\", requested=\"${action}\", next=\"${next}\"`)\n  console.log(`[TreeNode:${props.node.label}] packState:`, packState.value)\n  emit('set-pack-action', { pack_name: props.node.label, action: next })\n}\n\nfunction toggleInstall() {\n  toggleAction('install')\n}\n\nfunction toggleRemove() {\n  toggleAction('remove')\n}\n\nfunction toggleUpdate() {\n  toggleAction('update')\n}\n\nfunction onPrefixChange(e) {\n  if (!isPackEditable.value) return\n  const val = e.target.value\n  if (prefixTimer) clearTimeout(prefixTimer)\n  prefixTimer = setTimeout(() => sendSetPackPrefixCommand(val), 400)\n}\n\n// Legacy function for standalone page nodes (edge case)\nfunction onPageTitleChange(e) {\n  if (!isPageEditable.value) return\n  const editable = e.target.value\n  if (pageTimer) clearTimeout(pageTimer)\n  pageTimer = setTimeout(() => {\n    const newTitle = displayPrefixWithSlash.value\n      ? displayPrefixWithSlash.value + editable\n      : editable\n    sendRenamePageCommandLegacy(newTitle)\n  }, 400)\n}\n\nasync function sendSetPackPrefixCommand(prefix) {\n  if (store.busy) return\n  try {\n    store.busy = true\n    const response = await packsAction({\n      command: 'set_pack_prefix',\n      repo_url: store.repoUrl,\n      ref: store.ref,\n      data: { pack_name: props.node.label, prefix },\n    })\n    mergeDiff(store.packs, response.diff)\n    store.stateHash = response.state_hash\n    store.warnings = response.warnings\n  } catch (e) {\n    console.error('set_pack_prefix failed:', e)\n  } finally {\n    store.busy = false\n  }\n}\n\n// Legacy function for standalone page nodes (edge case)\nasync function sendRenamePageCommandLegacy(newTitle) {\n  if (store.busy || !parentName.value) return\n  try {\n    store.busy = true\n    const response = await packsAction({\n      command: 'rename_page',\n      repo_url: store.repoUrl,\n      ref: store.ref,\n      data: {\n        pack_name: parentName.value,\n        page_name: props.node.label,\n        new_title: newTitle,\n      },\n    })\n    mergeDiff(store.packs, response.diff)\n    store.stateHash = response.state_hash\n    store.warnings = response.warnings\n  } catch (e) {\n    console.error('rename_page failed:', e)\n  } finally {\n    store.busy = false\n  }\n}\n\nonBeforeUnmount(() => {\n  if (prefixTimer) clearTimeout(prefixTimer)\n  if (pageTimer) clearTimeout(pageTimer)\n})\n\nfunction $t(k) { return mw.msg(k) }\n\nfunction getPageTitle(pageName) {\n  const parentPack = store.packs[props.node.label]\n  const pageState = parentPack?.pages?.[pageName]\n  return pageState?.final_title || pageName\n}\n\nfunction getPageState(pageName) {\n  const parentPack = store.packs[props.node.label]\n  return parentPack?.pages?.[pageName] || null\n}\n\nfunction getPageBackground(pageName) {\n  const pageState = getPageState(pageName)\n  if (!pageState) return 'white'\n  \n  if (pageState.installed) return 'rgba(232, 240, 248, 0.4)'\n  if (packState.value?.action === 'install') return 'rgba(232, 245, 233, 0.6)'\n  if (packState.value?.action === 'remove') return 'rgba(255, 235, 238, 0.6)'\n  return 'white'\n}\n\nfunction getDisplayPrefix(pageName) {\n  return packState.value?.prefix || ''\n}\n\nfunction getDisplayPrefixWithSlash(pageName) {\n  const prefix = getDisplayPrefix(pageName)\n  return prefix ? (prefix.endsWith('/') ? prefix : prefix + '/') : ''\n}\n\nfunction getPageEditableTitle(pageName) {\n  const pageState = getPageState(pageName)\n  if (!pageState) return ''\n  \n  const full = pageState.final_title || ''\n  const pref = getDisplayPrefixWithSlash(pageName)\n  \n  // Remove prefix from the title to show only the editable part\n  if (pref && full.startsWith(pref)) {\n    return full.slice(pref.length)\n  }\n  \n  return full\n}\n\nfunction getPageHasCollision(pageName) {\n  const pageState = getPageState(pageName)\n  const full = pageState?.final_title\n  if (!full || !props.node.label) return false\n  return store.warnings.some(\n    (w) => w.includes(full) && w.includes(props.node.label)\n  )\n}\n\nfunction getCollisionTooltip(pageName) {\n  const pageState = getPageState(pageName)\n  const full = pageState?.final_title\n  if (!full || !props.node.label) return ''\n  return store.warnings\n    .filter((w) => w.includes(full) && w.includes(props.node.label))\n    .join('\\n')\n}\n\nfunction getCollisionId(pageName) {\n  return `collision-${props.node.label}-${pageName}`\n}\n\nfunction getPageEditable(pageName) {\n  // Check if this specific page can be edited\n  const pageState = getPageState(pageName)\n  if (!pageState) return false\n  \n  const action = packState.value?.action\n  \n  // Can edit if pack is being installed (and page is not already installed)\n  if (action === 'install' && !pageState.installed) return true\n  \n  // Can edit if pack is being updated\n  if (action === 'update') return true\n  \n  return false\n}\n\nfunction onPageTitleChangeForPage(e, pageName) {\n  // Check if pack is editable\n  const action = packState.value?.action\n  if (action !== 'install' && action !== 'update') {\n    console.log('[onPageTitleChangeForPage] Pack not in install/update mode, ignoring input')\n    return\n  }\n  \n  const pageState = getPageState(pageName)\n  if (!pageState) {\n    console.log('[onPageTitleChangeForPage] No page state found for', pageName)\n    return\n  }\n  \n  // For install action, only allow editing if page is not already installed\n  if (action === 'install' && pageState.installed) {\n    console.log('[onPageTitleChangeForPage] Page already installed, cannot rename during install')\n    return\n  }\n\n  const prefix = getDisplayPrefixWithSlash(pageName)\n  const newTitle = prefix ? prefix + e.target.value: e.target.value\n  console.log('[onPageTitleChangeForPage] zzzPage:', pageName, 'New value:', newTitle)\n  store.packs[props.node.label].pages[pageName].final_title = newTitle;\n\n  if (pageTimer) clearTimeout(pageTimer)\n  pageTimer = setTimeout(() => {\n    console.log('[onPageTitleChangeForPage] Sending rename command. Pack:', props.node.label, 'Page:', pageName, 'Title:', newTitle)\n    sendRenamePageCommand(pageName, newTitle)\n  }, 200)\n}\n\nasync function sendRenamePageCommand(pageName, newTitle) {\n  if (store.busy) return\n  try {\n    store.busy = true\n    const response = await packsAction({\n      command: 'rename_page',\n      repo_url: store.repoUrl,\n      ref: store.ref,\n      data: {\n        pack_name: props.node.label,\n        page_name: pageName,\n        new_title: newTitle,\n      },\n    })\n    store.stateHash = response.state_hash\n    store.warnings = response.warnings\n  } catch (e) {\n    console.error('rename_page failed:', e)\n  } finally {\n    store.busy = false\n  }\n}\n\nconst sortedChildren = computed(() => {\n  if (!props.node.children) return []\n  const arr = [...props.node.children]\n  const ci = (s) => (s || '').toLocaleLowerCase()\n  arr.sort((a, b) => {\n    if (a.type === 'page' && b.type !== 'page') return -1\n    if (a.type !== 'page' && b.type === 'page') return 1\n    const la = ci(a.label)\n    const lb = ci(b.label)\n    if (la < lb) return -1\n    if (la > lb) return 1\n    return 0\n  })\n  return arr\n})\n\n// Separate pages and nested packs\nconst childPages = computed(() => {\n  if (!props.node.children) return []\n  return props.node.children.filter(child => child.type === 'page')\n})\n\nconst childPacks = computed(() => {\n  if (!props.node.children) return []\n  return props.node.children.filter(child => child.type === 'pack')\n})\n\n// Smooth expand/collapse animations\nfunction onChildrenEnter(el) {\n  el.style.height = '0'\n  el.style.opacity = '0'\n  el.offsetHeight // Force reflow\n  el.style.transition = 'height 0.3s ease, opacity 0.3s ease'\n  el.style.height = el.scrollHeight + 'px'\n  el.style.opacity = '1'\n}\n\nfunction onChildrenLeave(el) {\n  el.style.height = el.scrollHeight + 'px'\n  el.offsetHeight // Force reflow\n  el.style.transition = 'height 0.3s ease, opacity 0.3s ease'\n  el.style.height = '0'\n  el.style.opacity = '0'\n}\n</script>\n\n<style>\n/*\n  ============================================================================\n  CSS CLASSES - SUPPLEMENTARY ONLY\n  ============================================================================\n  \n  ‚ö†Ô∏è IMPORTANT: These CSS classes are NOT used for layout or visual styling!\n  \n  WHY: MediaWiki and Codex have extremely high CSS specificity that overrides\n       our stylesheet classes. Inline styles (in the template above) have\n       the highest specificity and cannot be overridden.\n  \n  WHAT THIS SECTION DOES:\n  - Provides fallback styles for browsers without JS\n  - Defines animation/transition effects\n  - Sets display modes (flex, inline-flex, etc.) as base rules\n  - Provides semantic class names for debugging\n  \n  WHAT THIS SECTION DOES NOT DO:\n  - Control layout (padding, margin, borders) - use inline styles\n  - Control colors (background, border-color) - use inline styles\n  - Control visibility (shadows, opacity) - use inline styles\n  \n  IF YOU NEED TO CHANGE VISUAL APPEARANCE:\n  1. Update the :style=\"\" bindings in the <template> section above\n  2. Do NOT add new CSS classes here expecting them to work\n  3. Test by inspecting element in browser DevTools to verify inline styles\n  \n  ============================================================================\n*/\n\n/* ==================== TREE NODE BASE ==================== */\n\n.labki-tree .tree-node {\n  margin-bottom: 0 !important;\n}\n\n/* ==================== PACK CARD - PROPER NESTING ==================== */\n/* Most styling is inline (see template) */\n\n.labki-tree .pack-card {\n  transition: all 0.2s ease !important;\n}\n\n/* Shadow hierarchy - deeper = lighter shadow */\n.labki-tree .pack-card[data-depth=\"0\"] {\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;\n}\n\n.labki-tree .pack-card[data-depth=\"1\"] {\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08) !important;\n}\n\n.labki-tree .pack-card[data-depth=\"2\"] {\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06) !important;\n}\n\n.labki-tree .pack-card[data-depth=\"3\"],\n.labki-tree .pack-card[data-depth=\"4\"],\n.labki-tree .pack-card[data-depth=\"5\"] {\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04) !important;\n}\n\n/* Subtle installed state */\n.labki-tree .tree-node[data-installed=\"true\"] .pack-card {\n  background: #f8f9fa !important;\n  border-color: #a2a9b1 !important;\n}\n\n/* Subtle action state overlays */\n.labki-tree .tree-node[data-action=\"install\"] .pack-card {\n  background: linear-gradient(to right, #e8f5e9 0%, #ffffff 100%) !important;\n  border-left: 3px solid #36c !important;\n}\n\n.labki-tree .tree-node[data-action=\"remove\"] .pack-card {\n  background: linear-gradient(to right, #ffebee 0%, #ffffff 100%) !important;\n  border-left: 3px solid #d33 !important;\n}\n\n.labki-tree .tree-node[data-action=\"update\"] .pack-card {\n  background: linear-gradient(to right, #fff8e1 0%, #ffffff 100%) !important;\n  border-left: 3px solid #fc3 !important;\n}\n\n.labki-tree .pack-card:hover {\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12) !important;\n}\n\n/* ==================== NODE ROW - HORIZONTAL LAYOUT ==================== */\n\n.labki-tree .pack-card .node-row {\n  display: flex !important;\n  align-items: center !important;\n  flex-wrap: nowrap !important;\n  gap: 8px !important;\n  min-height: 40px !important;\n}\n\n.labki-tree .name-section {\n  display: inline-flex !important;\n  align-items: center !important;\n  gap: 8px !important;\n  flex-shrink: 0 !important;\n  flex-wrap: nowrap !important;\n}\n\n.labki-tree .spacer {\n  display: inline-block !important;\n  flex-grow: 1 !important;\n  min-width: 12px !important;\n}\n\n/* ==================== TOGGLE & ICON ==================== */\n\n.labki-tree .toggle {\n  background: none !important;\n  border: none !important;\n  cursor: pointer !important;\n  padding: 4px !important;\n  font-size: 12px !important;\n  color: #72777d !important;\n  flex-shrink: 0 !important;\n  width: 24px !important;\n  height: 24px !important;\n  display: inline-flex !important;\n  align-items: center !important;\n  justify-content: center !important;\n  border-radius: 4px !important;\n  transition: all 0.15s ease !important;\n}\n\n.labki-tree .toggle:hover {\n  background: #eaecf0 !important;\n  color: #202122 !important;\n}\n\n.labki-tree .toggle-spacer {\n  width: 24px !important;\n  flex-shrink: 0 !important;\n  display: inline-block !important;\n}\n\n.labki-tree .node-icon {\n  font-size: 20px !important;\n  line-height: 1 !important;\n  flex-shrink: 0 !important;\n}\n\n.labki-tree .label {\n  font-size: 1em !important;\n  font-weight: 600 !important;\n  color: #202122 !important;\n  white-space: nowrap !important;\n}\n\n/* ==================== BADGES ==================== */\n\n.labki-tree .badge {\n  display: inline-flex !important;\n  align-items: center !important;\n  font-size: 0.75em !important;\n  padding: 4px 10px !important;\n  border-radius: 12px !important;\n  white-space: nowrap !important;\n  font-weight: 500 !important;\n  flex-shrink: 0 !important;\n}\n\n.labki-tree .badge.manual {\n  background: #eaf3ff !important;\n  color: #36c !important;\n  border: 1px solid #b8d4ff !important;\n}\n\n.labki-tree .badge.auto {\n  background: #fef6e7 !important;\n  color: #ac6600 !important;\n  border: 1px solid #fce29f !important;\n}\n\n.labki-tree .badge.version {\n  background: #f0f0f0 !important;\n  color: #54595d !important;\n  border: 1px solid #c8ccd1 !important;\n}\n\n.labki-tree .badge.update {\n  background: #fff3cd !important;\n  color: #8a6d3b !important;\n  border: 1px solid #fce29f !important;\n  animation: pulse 2s infinite !important;\n}\n\n@keyframes pulse {\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0.7; }\n}\n\n/* ==================== INLINE EDITORS ==================== */\n\n.labki-tree .prefix-editor-inline {\n  display: inline-flex !important;\n  align-items: center !important;\n  gap: 6px !important;\n  margin-left: 8px !important;\n  flex-wrap: nowrap !important;\n  flex-shrink: 0 !important;\n}\n\n.labki-tree .arrow {\n  color: #72777d !important;\n  font-size: 1.1em !important;\n  flex-shrink: 0 !important;\n}\n\n.labki-tree .prefix-label {\n  font-size: 0.85em !important;\n  color: #54595d !important;\n  white-space: nowrap !important;\n  flex-shrink: 0 !important;\n  font-weight: 500 !important;\n}\n\n.labki-tree .prefix-input {\n  padding: 6px 10px !important;\n  border: 1px solid #c8ccd1 !important;\n  border-radius: 4px !important;\n  font-size: 0.85em !important;\n  font-family: 'Monaco', 'Menlo', 'Consolas', monospace !important;\n  background: white !important;\n  color: #202122 !important;\n  width: 180px !important;\n  flex-shrink: 0 !important;\n  transition: all 0.15s ease !important;\n}\n\n.labki-tree .prefix-input:focus {\n  outline: none !important;\n  border-color: #36c !important;\n  box-shadow: 0 0 0 1px #36c !important;\n}\n\n.labki-tree .prefix-input:disabled,\n.labki-tree .prefix-input[readonly] {\n  background: #f8f9fa !important;\n  color: #72777d !important;\n  cursor: not-allowed !important;\n}\n\n/* ==================== META ROW ==================== */\n/* Most styling is inline (see template) */\n\n/* ==================== CHILDREN CONTAINER (INSIDE CARD) ==================== */\n/* Most styling is inline (see template) */\n\n.labki-tree .children {\n  overflow: hidden !important;\n}\n\n/* Smooth transitions */\n.labki-tree .children-enter-active,\n.labki-tree .children-leave-active {\n  transition: all 0.3s ease !important;\n}\n\n.labki-tree .children-enter-from,\n.labki-tree .children-leave-to {\n  opacity: 0 !important;\n  height: 0 !important;\n}\n\n/* ==================== PAGE ROW ==================== */\n\n.labki-tree .page-row {\n  display: flex !important;\n  align-items: center !important;\n  flex-wrap: nowrap !important;\n  gap: 8px !important;\n  padding: 8px 12px !important;\n  background: rgba(255, 255, 255, 0.5) !important;\n  border-radius: 6px !important;\n  margin-bottom: 6px !important;\n  transition: all 0.15s ease !important;\n  min-height: 36px !important;\n}\n\n.labki-tree .page-row:hover {\n  background: #f8f9fa !important;\n}\n\n.labki-tree .tree-node[data-installed=\"true\"] .page-row {\n  background: rgba(232, 240, 248, 0.4) !important;\n}\n\n.labki-tree .tree-node[data-action=\"install\"] .page-row {\n  background: rgba(232, 245, 233, 0.6) !important;\n}\n\n.labki-tree .tree-node[data-action=\"remove\"] .page-row {\n  background: rgba(255, 235, 238, 0.6) !important;\n}\n\n/* Page rename editor */\n.labki-tree .page-rename-inline {\n  display: inline-flex !important;\n  align-items: center !important;\n  gap: 0 !important;\n  margin-left: 8px !important;\n  flex-wrap: nowrap !important;\n  flex-shrink: 0 !important;\n}\n\n.labki-tree .prefix-chip-inline {\n  padding: 6px 10px !important;\n  background: #f0f0f0 !important;\n  border: 1px solid #c8ccd1 !important;\n  border-right: none !important;\n  border-radius: 4px 0 0 4px !important;\n  font-size: 0.85em !important;\n  font-family: 'Monaco', 'Menlo', 'Consolas', monospace !important;\n  color: #54595d !important;\n  white-space: nowrap !important;\n}\n\n.labki-tree .page-input {\n  padding: 6px 10px !important;\n  border: 1px solid #c8ccd1 !important;\n  border-radius: 4px !important;\n  font-size: 0.85em !important;\n  font-family: 'Monaco', 'Menlo', 'Consolas', monospace !important;\n  background: white !important;\n  color: #202122 !important;\n  width: 160px !important;\n  flex-shrink: 0 !important;\n  transition: all 0.15s ease !important;\n}\n\n.labki-tree .prefix-chip-inline + .page-input {\n  border-radius: 0 4px 4px 0 !important;\n}\n\n.labki-tree .page-input:focus {\n  outline: none !important;\n  border-color: #36c !important;\n  box-shadow: 0 0 0 1px #36c !important;\n}\n\n.labki-tree .page-input:disabled,\n.labki-tree .page-input[readonly] {\n  background: #f8f9fa !important;\n  color: #72777d !important;\n  cursor: not-allowed !important;\n}\n\n.labki-tree .page-input.has-collision {\n  border-color: #d33 !important;\n  background: #fff5f5 !important;\n}\n\n.labki-tree .collision-icon {\n  font-size: 1.1em !important;\n  cursor: help !important;\n  margin-left: 4px !important;\n}\n\n/* ==================== ACTION BUTTONS ==================== */\n\n.labki-tree .actions {\n  display: inline-flex !important;\n  align-items: center !important;\n  gap: 8px !important;\n  flex-shrink: 0 !important;\n  flex-wrap: nowrap !important;\n}\n\n.labki-tree .action-item {\n  display: inline-flex !important;\n  flex-shrink: 0 !important;\n}\n\n.labki-tree :deep(.cdx-button) {\n  display: inline-flex !important;\n  font-size: 0.9em !important;\n  padding: 8px 16px !important;\n  transition: all 0.2s ease !important;\n  white-space: nowrap !important;\n  flex-shrink: 0 !important;\n  border-radius: 6px !important;\n}\n\n/* Active state styling */\n.labki-tree :deep(.cdx-button.active[action=\"progressive\"]) {\n  background-color: #2a4b8d !important;\n  border-color: #2a4b8d !important;\n  color: white !important;\n  font-weight: 600 !important;\n  box-shadow: 0 0 0 3px rgba(54, 108, 204, 0.2) !important;\n  transform: scale(1.02) !important;\n}\n\n.labki-tree :deep(.cdx-button.active[action=\"destructive\"]) {\n  background-color: #d73333 !important;\n  border-color: #d73333 !important;\n  color: white !important;\n  font-weight: 600 !important;\n  box-shadow: 0 0 0 3px rgba(215, 51, 51, 0.2) !important;\n  transform: scale(1.02) !important;\n}\n\n.labki-tree :deep(.cdx-button.active:not([action=\"progressive\"]):not([action=\"destructive\"])) {\n  background-color: #fc3 !important;\n  border-color: #fc3 !important;\n  color: #202122 !important;\n  font-weight: 600 !important;\n  box-shadow: 0 0 0 3px rgba(255, 204, 51, 0.2) !important;\n  transform: scale(1.02) !important;\n}\n\n.labki-tree :deep(.cdx-button:hover) {\n  transform: translateY(-1px) !important;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;\n}\n\n.labki-tree :deep(.cdx-button:active) {\n  transform: translateY(0) !important;\n}\n\n/* ==================== RESPONSIVE ADJUSTMENTS ==================== */\n\n@media (max-width: 768px) {\n  .labki-tree .pack-card {\n    padding: 10px !important;\n  }\n  \n  .labki-tree .node-row {\n    flex-wrap: wrap !important;\n  }\n  \n  .labki-tree .actions {\n    width: 100% !important;\n    justify-content: flex-start !important;\n    margin-top: 8px !important;\n  }\n  \n  .labki-tree .prefix-editor-inline,\n  .labki-tree .page-rename-inline {\n    width: 100% !important;\n    margin-left: 0 !important;\n    margin-top: 8px !important;\n  }\n}\n</style>","<template>\n  <div class=\"hierarchy-tree-container\">\n    <h3>{{ $t('labkipackmanager-hierarchy-title') }}</h3>\n    \n    <div v-if=\"!hierarchy\" class=\"no-hierarchy\">\n      <p>{{ $t('labkipackmanager-no-hierarchy-loaded') }}</p>\n    </div>\n    \n    <div v-else class=\"tree-content\">\n      <div class=\"tree-stats\">\n        <span>{{ $t('labkipackmanager-pack-count') }}: {{ hierarchy.meta.pack_count }}</span>\n        <span>{{ $t('labkipackmanager-page-count') }}: {{ hierarchy.meta.page_count }}</span>\n      </div>\n      \n      <div class=\"tree-nodes labki-tree\">\n        <tree-node\n          v-for=\"node in hierarchy.root_nodes\"\n          :key=\"node.id\"\n          :node=\"node\"\n          :depth=\"0\"\n          @set-pack-action=\"onSetPackAction\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { store } from '../state/store';\nimport { packsAction } from '../api/endpoints';\nimport { mergeDiff } from '../state/merge';\nimport TreeNode from './TreeNode.vue';\n\ndefineProps({\n  hierarchy: Object\n});\n\nasync function onSetPackAction(payload) {\n  // Send set_pack_action command to backend\n  await sendCommand('set_pack_action', {\n    pack_name: payload.pack_name,\n    action: payload.action\n  });\n}\n\nasync function sendCommand(command, data) {\n  if (store.busy) return;\n  \n  try {\n    store.busy = true;\n    \n    console.log(`[sendCommand] Sending ${command}:`, data);\n    const response = await packsAction({\n      command,\n      repo_url: store.repoUrl,\n      ref: store.ref,\n      data,\n    });\n    \n    console.log(`[sendCommand] Response diff:`, response.diff);\n    console.log(`[sendCommand] Pack state before merge:`, data.pack_name ? store.packs[data.pack_name] : 'N/A');\n    \n    // Merge diff into store\n    mergeDiff(store.packs, response.diff);\n    store.stateHash = response.state_hash;\n    store.warnings = response.warnings;\n    \n    console.log(`[sendCommand] Pack state after merge:`, data.pack_name ? store.packs[data.pack_name] : 'N/A');\n  } catch (e) {\n    console.error('Command failed:', e);\n    // You might want to emit an error event here\n  } finally {\n    store.busy = false;\n  }\n}\n\n// Helper for i18n\nfunction $t(key) {\n  return mw.msg(key);\n}\n</script>\n\n<style scoped>\n.hierarchy-tree-container {\n  padding: 20px;\n  background: white;\n  border: 1px solid #c8ccd1;\n  border-radius: 8px;\n  margin-bottom: 20px;\n  width: 100%;\n  max-width: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\nh3 {\n  margin-top: 0;\n  margin-bottom: 16px;\n  font-size: 1.2em;\n}\n\n.no-hierarchy {\n  padding: 16px;\n  text-align: center;\n  color: #72777d;\n}\n\n.no-hierarchy p {\n  margin: 0;\n}\n\n.tree-stats {\n  display: flex;\n  gap: 24px;\n  padding: 12px;\n  background: #f8f9fa;\n  border-radius: 4px;\n  margin-bottom: 16px;\n  font-size: 0.9em;\n}\n\n.tree-nodes {\n  margin-top: 16px;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n}\n</style>\n\n","<template>\n  <div class=\"details-panel\">\n    <div class=\"panel-header\">\n      <h3>{{ $t('labkipackmanager-details-title') }}</h3>\n      <div v-if=\"selectedPacks.length > 0\" class=\"pack-count-badge\">\n        {{ selectedPacks.length }} {{ selectedPacks.length === 1 ? 'pack' : 'packs' }}\n      </div>\n    </div>\n    \n    <div class=\"panel-content\">\n      <!-- Warnings Section -->\n      <div v-if=\"store.warnings.length > 0\" class=\"warnings-section\">\n        <div class=\"section-header\">\n          <span class=\"section-icon\">‚ö†Ô∏è</span>\n          <h4>{{ $t('labkipackmanager-warnings') }}</h4>\n        </div>\n        <div class=\"warnings-list\">\n          <cdx-message\n            v-for=\"(warning, index) in store.warnings\"\n            :key=\"index\"\n            type=\"warning\"\n            :inline=\"true\"\n          >\n            {{ warning }}\n          </cdx-message>\n        </div>\n      </div>\n      \n      <!-- Selected Packs Section -->\n      <div v-if=\"selectedPacks.length > 0\" class=\"selected-packs-section\">\n        <div class=\"section-header\">\n          <span class=\"section-icon\">üì¶</span>\n          <h4>{{ $t('labkipackmanager-selected-packs') }}</h4>\n        </div>\n        <div class=\"packs-grid\">\n          <div\n            v-for=\"pack in selectedPacks\"\n            :key=\"pack.name\"\n            class=\"pack-card\"\n            :style=\"{\n              position: 'relative',\n              padding: '12px 14px',\n              paddingLeft: packStatuses[pack.name] ? '20px' : '14px',\n              background: packStatuses[pack.name] === 'running' ? 'linear-gradient(135deg, #f0f5ff 0%, #ffffff 100%)' :\n                          packStatuses[pack.name] === 'complete' ? 'linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%)' :\n                          packStatuses[pack.name] === 'failed' ? 'linear-gradient(135deg, #fff5f5 0%, #ffffff 100%)' :\n                          packStatuses[pack.name] === 'pending' ? '#fafbfc' :\n                          'white',\n              border: '2px solid #eaecf0',\n              borderLeft: packStatuses[pack.name] === 'running' ? '4px solid #3366cc' :\n                          packStatuses[pack.name] === 'complete' ? '4px solid #14866d' :\n                          packStatuses[pack.name] === 'failed' ? '4px solid #d33' :\n                          packStatuses[pack.name] === 'pending' ? '4px solid #c8ccd1' :\n                          '2px solid #eaecf0',\n              borderRadius: '10px',\n              boxShadow: '0 2px 6px rgba(0, 0, 0, 0.08)',\n              marginBottom: '10px',\n              transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n              overflow: 'hidden'\n            }\"\n          >\n            \n            <div class=\"pack-header\" :style=\"{\n              display: 'flex',\n              alignItems: 'flex-start',\n              justifyContent: 'space-between',\n              gap: '10px',\n              marginBottom: '10px'\n            }\">\n              <div class=\"pack-title-section\" :style=\"{\n                display: 'flex',\n                alignItems: 'flex-start',\n                gap: '10px',\n                flex: '1'\n              }\">\n                <div class=\"pack-icon\" :style=\"{ fontSize: '1.6em', lineHeight: '1' }\">üì¶</div>\n                <div class=\"pack-name-wrapper\" :style=\"{\n                  display: 'flex',\n                  flexDirection: 'column',\n                  gap: '6px',\n                  minWidth: '0'\n                }\">\n                  <strong class=\"pack-name\" :style=\"{\n                    fontSize: '1em',\n                    color: '#202122',\n                    wordBreak: 'break-word'\n                  }\">{{ pack.name }}</strong>\n                  <div class=\"pack-meta-row\" :style=\"{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '6px',\n                    flexWrap: 'wrap'\n                  }\">\n                    <span \n                      v-if=\"pack.state.auto_selected_reason\" \n                      class=\"pack-badge auto\"\n                      :title=\"pack.state.auto_selected_reason\"\n                      :style=\"{\n                        fontSize: '0.7em',\n                        padding: '3px 8px',\n                        borderRadius: '5px',\n                        fontWeight: '600',\n                        background: 'linear-gradient(135deg, #fef6e7 0%, #fff8e1 100%)',\n                        color: '#ac6600',\n                        border: '1px solid #f0d86f',\n                        whiteSpace: 'nowrap'\n                      }\"\n                    >\n                      ü§ñ Auto\n                    </span>\n                    <span v-else class=\"pack-badge manual\" :style=\"{\n                      fontSize: '0.7em',\n                      padding: '3px 8px',\n                      borderRadius: '5px',\n                      fontWeight: '600',\n                      background: 'linear-gradient(135deg, #eaf3ff 0%, #f0f6ff 100%)',\n                      color: '#36c',\n                      border: '1px solid #a8c9f0',\n                      whiteSpace: 'nowrap'\n                    }\">\n                      ‚úã Manual\n                    </span>\n                    <span class=\"action-badge\" :style=\"{\n                      fontSize: '0.7em',\n                      padding: '3px 10px',\n                      borderRadius: '5px',\n                      fontWeight: '700',\n                      textTransform: 'uppercase',\n                      letterSpacing: '0.3px',\n                      whiteSpace: 'nowrap',\n                      background: pack.state.action === 'install' ? 'linear-gradient(135deg, #d5fdf0 0%, #e8fff8 100%)' :\n                                  pack.state.action === 'update' ? 'linear-gradient(135deg, #fff4e5 0%, #fff8ed 100%)' :\n                                  pack.state.action === 'remove' ? 'linear-gradient(135deg, #fee7e6 0%, #fff0ef 100%)' :\n                                  '#f8f9fa',\n                      color: pack.state.action === 'install' ? '#14866d' :\n                             pack.state.action === 'update' ? '#ac6600' :\n                             pack.state.action === 'remove' ? '#d33' :\n                             '#54595d',\n                      border: pack.state.action === 'install' ? '1px solid #7fd4bf' :\n                              pack.state.action === 'update' ? '1px solid #f0c77e' :\n                              pack.state.action === 'remove' ? '1px solid #faa' :\n                              '1px solid #c8ccd1'\n                    }\">\n                      {{ getActionIcon(pack.state.action) }} {{ pack.state.action }}\n                    </span>\n                  </div>\n                </div>\n              </div>\n              \n              <!-- Operation Status Badge -->\n              <div v-if=\"packStatuses[pack.name]\" class=\"operation-status\" :style=\"{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '6px',\n                padding: '5px 12px',\n                borderRadius: '16px',\n                fontSize: '0.8em',\n                fontWeight: '700',\n                whiteSpace: 'nowrap',\n                flexShrink: '0',\n                background: packStatuses[pack.name] === 'pending' ? 'linear-gradient(135deg, #f8f9fa 0%, #eaecf0 100%)' :\n                            packStatuses[pack.name] === 'running' ? 'linear-gradient(135deg, #3366cc 0%, #447ff5 100%)' :\n                            packStatuses[pack.name] === 'complete' ? 'linear-gradient(135deg, #14866d 0%, #00af89 100%)' :\n                            'linear-gradient(135deg, #d33 0%, #ff4444 100%)',\n                color: packStatuses[pack.name] === 'pending' ? '#54595d' : 'white',\n                boxShadow: '0 2px 8px rgba(0, 0, 0, 0.15)',\n                animation: packStatuses[pack.name] === 'running' ? 'pulse 2s ease-in-out infinite' : 'none'\n              }\">\n                <span v-if=\"packStatuses[pack.name] === 'pending'\" :style=\"{ fontSize: '1.2em' }\">‚è≥</span>\n                <span v-else-if=\"packStatuses[pack.name] === 'running'\" class=\"status-icon spinning\" :style=\"{ fontSize: '1.2em' }\">‚öôÔ∏è</span>\n                <span v-else-if=\"packStatuses[pack.name] === 'complete'\" :style=\"{ fontSize: '1.2em' }\">‚úÖ</span>\n                <span v-else-if=\"packStatuses[pack.name] === 'failed'\" :style=\"{ fontSize: '1.2em' }\">‚ùå</span>\n                <span class=\"status-text\" :style=\"{ fontWeight: '700' }\">{{ getStatusText(packStatuses[pack.name]) }}</span>\n              </div>\n            </div>\n            \n            <div class=\"pack-info-grid\" :style=\"{\n              display: 'grid',\n              gridTemplateColumns: 'repeat(auto-fit, minmax(110px, 1fr))',\n              gap: '8px',\n              paddingTop: '10px',\n              marginTop: '2px',\n              borderTop: '1px solid #eaecf0'\n            }\">\n              <div v-if=\"pack.state.target_version\" class=\"info-item\" :style=\"{\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '4px',\n                padding: '6px 10px',\n                background: '#f8f9fa',\n                borderRadius: '6px',\n                border: '1px solid #eaecf0'\n              }\">\n                <span class=\"info-label\" :style=\"{\n                  fontSize: '0.65em',\n                  color: '#72777d',\n                  fontWeight: '700',\n                  textTransform: 'uppercase',\n                  letterSpacing: '0.4px'\n                }\">Version</span>\n                <span class=\"info-value\" :style=\"{\n                  fontSize: '0.88em',\n                  color: '#202122',\n                  fontWeight: '600'\n                }\">{{ pack.state.target_version }}</span>\n              </div>\n              <div v-if=\"pack.state.prefix\" class=\"info-item\" :style=\"{\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '4px',\n                padding: '6px 10px',\n                background: '#f8f9fa',\n                borderRadius: '6px',\n                border: '1px solid #eaecf0'\n              }\">\n                <span class=\"info-label\" :style=\"{\n                  fontSize: '0.65em',\n                  color: '#72777d',\n                  fontWeight: '700',\n                  textTransform: 'uppercase',\n                  letterSpacing: '0.4px'\n                }\">Prefix</span>\n                <span class=\"info-value code\" :style=\"{\n                  fontSize: '0.85em',\n                  color: '#202122',\n                  fontWeight: '500',\n                  fontFamily: 'Monaco, Menlo, Consolas, monospace',\n                  background: 'white',\n                  padding: '3px 6px',\n                  borderRadius: '3px',\n                  border: '1px solid #c8ccd1'\n                }\">{{ pack.state.prefix }}</span>\n              </div>\n              <div v-if=\"pack.pageCount > 0\" class=\"info-item\" :style=\"{\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '6px',\n                padding: '6px 10px',\n                background: '#f8f9fa',\n                borderRadius: '6px',\n                border: '1px solid #eaecf0',\n                gridColumn: pack.state.prefix ? 'span 1' : 'span 2'\n              }\">\n                <span class=\"info-label\" :style=\"{\n                  fontSize: '0.65em',\n                  color: '#72777d',\n                  fontWeight: '700',\n                  textTransform: 'uppercase',\n                  letterSpacing: '0.4px'\n                }\">Pages ({{ pack.pageCount }})</span>\n                <div class=\"pages-list\" :style=\"{\n                  display: 'flex',\n                  flexDirection: 'column',\n                  gap: '3px'\n                }\">\n                  <div \n                    v-for=\"(pageState, pageName) in pack.state.pages\" \n                    :key=\"pageName\"\n                    :style=\"{\n                      fontSize: '0.75em',\n                      color: '#202122',\n                      padding: '2px 4px',\n                      background: 'white',\n                      borderRadius: '3px',\n                      border: '1px solid #eaecf0',\n                      fontFamily: 'Monaco, Menlo, Consolas, monospace',\n                      overflow: 'hidden',\n                      textOverflow: 'ellipsis',\n                      whiteSpace: 'nowrap'\n                    }\"\n                    :title=\"`${pageName} ‚Üí ${pageState.final_title}`\"\n                  >\n                    <span :style=\"{ color: '#72777d' }\">üìÑ</span>\n                    {{ pageState.final_title || pageName }}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div v-else class=\"empty-state\">\n        <div class=\"empty-icon\">üìã</div>\n        <p class=\"empty-text\">{{ $t('labkipackmanager-no-packs-selected') }}</p>\n        <p class=\"empty-hint\">Select packs from the hierarchy tree to see details here</p>\n      </div>\n      \n      <!-- Action Buttons -->\n      <div class=\"actions-section\">\n        <div class=\"action-buttons\">\n          <cdx-button\n            action=\"progressive\"\n            weight=\"primary\"\n            :disabled=\"store.busy || selectedPacks.length === 0\"\n            @click=\"onApply\"\n          >\n            ‚úì {{ $t('labkipackmanager-apply') }}\n          </cdx-button>\n          \n          <cdx-button\n            action=\"default\"\n            :disabled=\"store.busy\"\n            @click=\"onRefresh\"\n          >\n            üîÑ {{ $t('labkipackmanager-refresh') }}\n          </cdx-button>\n          \n          <cdx-button\n            action=\"destructive\"\n            weight=\"quiet\"\n            :disabled=\"store.busy\"\n            @click=\"onClear\"\n          >\n            ‚úï {{ $t('labkipackmanager-clear') }}\n          </cdx-button>\n        </div>\n        \n        <!-- Operation Status -->\n        <cdx-message\n          v-if=\"operationMessage\"\n          type=\"success\"\n          :inline=\"true\"\n        >\n          {{ operationMessage }}\n        </cdx-message>\n        \n        <cdx-message\n          v-if=\"errorMessage\"\n          type=\"error\"\n          :inline=\"true\"\n        >\n          {{ errorMessage }}\n        </cdx-message>\n        \n        <!-- State Hash (Debug) -->\n        <div v-if=\"store.stateHash\" class=\"state-info\">\n          <small>{{ $t('labkipackmanager-state-hash') }}: <code>{{ store.stateHash }}</code></small>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue';\nimport { CdxButton, CdxMessage } from '@wikimedia/codex';\nimport { store } from '../state/store';\nimport { packsAction, pollOperation } from '../api/endpoints';\nimport { mergeDiff } from '../state/merge';\n\nconst operationMessage = ref('');\nconst errorMessage = ref('');\nconst packStatuses = ref({}); // Track status of each pack during apply\n\nconst selectedPacks = computed(() => {\n  const packs = [];\n  \n  for (const [name, state] of Object.entries(store.packs)) {\n    // Show packs that have any action set (not 'unchanged')\n    // This includes install, update, and remove actions\n    if (state.action && state.action !== 'unchanged') {\n      packs.push({\n        name,\n        state,\n        pageCount: Object.keys(state.pages || {}).length,\n      });\n    }\n  }\n  \n  return packs;\n});\n\nasync function onApply() {\n  if (store.busy) return;\n  \n  try {\n    store.busy = true;\n    operationMessage.value = '';\n    errorMessage.value = '';\n    \n    // Initialize all selected packs as 'pending'\n    packStatuses.value = {};\n    for (const pack of selectedPacks.value) {\n      packStatuses.value[pack.name] = 'pending';\n    }\n    \n    // Step 1: Send apply command (queues background job)\n    operationMessage.value = 'Queueing pack operations...';\n    \n    const response = await packsAction({\n      command: 'apply',\n      repo_url: store.repoUrl,\n      ref: store.ref,\n      data: {\n        // Send current pack state with all the actions user has marked\n        packs: store.packs,\n        // Send state hash so backend can verify states are in sync\n        state_hash: store.stateHash,\n      },\n    });\n    \n    console.log('[onApply] Apply response:', response);\n    \n    // Merge diff (session state is cleared by backend)\n    mergeDiff(store.packs, response.diff);\n    store.stateHash = response.state_hash;\n    store.warnings = response.warnings;\n    \n    // Step 2: If we got an operation_id, poll for completion\n    if (response.operation?.operation_id) {\n      const operationId = response.operation.operation_id;\n      console.log(`[onApply] Polling operation ${operationId}...`);\n      \n      // Poll with status updates\n      await pollOperation(\n        operationId,\n        120, // 2 minutes max (pack operations can be slower)\n        1000,\n        (status) => {\n          // Update message based on operation status\n          if (status.message) {\n            operationMessage.value = status.message;\n            \n            // Parse message to update pack statuses\n            updatePackStatusFromMessage(status.message);\n          } else if (status.status === 'queued') {\n            operationMessage.value = 'Waiting for job to start...';\n          } else if (status.status === 'running') {\n            operationMessage.value = `Applying packs... (${status.progress || 0}%)`;\n          }\n        }\n      );\n      \n      console.log('[onApply] Operation completed successfully');\n      \n      // Mark all remaining as complete\n      for (const packName in packStatuses.value) {\n        if (packStatuses.value[packName] !== 'failed') {\n          packStatuses.value[packName] = 'complete';\n        }\n      }\n      \n      operationMessage.value = 'All packs applied successfully!';\n      \n      // Clear statuses after a delay\n      setTimeout(() => {\n        packStatuses.value = {};\n      }, 3000);\n    } else {\n      // No operation queued (maybe no changes?)\n      operationMessage.value = $t('labkipackmanager-apply-success');\n      packStatuses.value = {};\n    }\n  } catch (e) {\n    console.error('[onApply] Error:', e);\n    errorMessage.value = e instanceof Error ? e.message : String(e);\n    operationMessage.value = '';\n    \n    // Mark all as failed\n    for (const packName in packStatuses.value) {\n      packStatuses.value[packName] = 'failed';\n    }\n  } finally {\n    store.busy = false;\n  }\n}\n\nfunction updatePackStatusFromMessage(message) {\n  // Parse backend messages to update pack statuses\n  // Messages like: \"Installing pack: People\", \"Removing pack: Miniscopes\", etc.\n  \n  const installMatch = message.match(/Installing pack[:\\s]+(.+)/i);\n  const updateMatch = message.match(/Updating pack[:\\s]+(.+)/i);\n  const removeMatch = message.match(/Removing pack[:\\s]+(.+)/i);\n  const completeMatch = message.match(/Completed pack[:\\s]+(.+)/i);\n  \n  if (installMatch || updateMatch || removeMatch) {\n    const packName = (installMatch || updateMatch || removeMatch)[1].trim();\n    if (packStatuses.value[packName] !== undefined) {\n      packStatuses.value[packName] = 'running';\n    }\n  } else if (completeMatch) {\n    const packName = completeMatch[1].trim();\n    if (packStatuses.value[packName] !== undefined) {\n      packStatuses.value[packName] = 'complete';\n    }\n  }\n}\n\nfunction getStatusText(status) {\n  switch (status) {\n    case 'pending': return 'Pending';\n    case 'running': return 'In Progress';\n    case 'complete': return 'Complete';\n    case 'failed': return 'Failed';\n    default: return '';\n  }\n}\n\nfunction getActionIcon(action) {\n  switch (action) {\n    case 'install': return '‚¨áÔ∏è';\n    case 'update': return 'üîÑ';\n    case 'remove': return 'üóëÔ∏è';\n    default: return '';\n  }\n}\n\nasync function onRefresh() {\n  if (store.busy) return;\n  \n  try {\n    store.busy = true;\n    operationMessage.value = '';\n    errorMessage.value = '';\n    \n    const response = await packsAction({\n      command: 'refresh',\n      repo_url: store.repoUrl,\n      ref: store.ref,\n      data: {},\n    });\n    \n    // Merge diff\n    mergeDiff(store.packs, response.diff);\n    store.stateHash = response.state_hash;\n    store.warnings = response.warnings;\n    \n    operationMessage.value = $t('labkipackmanager-refresh-success');\n  } catch (e) {\n    errorMessage.value = e instanceof Error ? e.message : String(e);\n  } finally {\n    store.busy = false;\n  }\n}\n\nasync function onClear() {\n  if (store.busy) return;\n  \n  if (!confirm($t('labkipackmanager-clear-confirm'))) {\n    return;\n  }\n  \n  try {\n    store.busy = true;\n    operationMessage.value = '';\n    errorMessage.value = '';\n    \n    // Reset state before clear - like init, clear returns full initial state\n    store.packs = {};\n    store.warnings = [];\n    \n    const response = await packsAction({\n      command: 'clear',\n      repo_url: store.repoUrl,\n      ref: store.ref,\n      data: {},\n    });\n    \n    // For Clear, replace the entire packs state (don't merge)\n    // This ensures all actions are reset to their initial state\n    store.packs = response.diff;\n    store.stateHash = response.state_hash;\n    store.warnings = response.warnings;\n    \n    operationMessage.value = $t('labkipackmanager-clear-success');\n  } catch (e) {\n    errorMessage.value = e instanceof Error ? e.message : String(e);\n  } finally {\n    store.busy = false;\n  }\n}\n\n// Helper for i18n\nfunction $t(key) {\n  return mw.msg(key);\n}\n</script>\n\n<style scoped>\n/*\n  ============================================================================\n  DETAILS PANEL - CARD-BASED DESIGN WITH INLINE STYLES\n  ============================================================================\n  \n  Following the same pattern as TreeNode.vue:\n  \n  ‚ö†Ô∏è INLINE STYLES ARE REQUIRED for layout and visual styling!\n  \n  WHY: MediaWiki/Codex CSS has extremely high specificity that overrides\n       our stylesheet classes. Inline styles have highest specificity.\n  \n  - Pack cards use inline :style=\"\" bindings for all visual properties\n  - CSS classes here only provide base structure and animations\n  - Any layout-critical styling MUST be in :style=\"\" bindings\n  \n  ============================================================================\n*/\n\n/* ==================== PANEL CONTAINER ==================== */\n\n.details-panel {\n  padding: 20px;\n  background: white;\n  border: 1px solid #c8ccd1;\n  border-radius: 8px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);\n}\n\n.panel-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 14px;\n  padding-bottom: 12px;\n  border-bottom: 2px solid #eaecf0;\n}\n\n.panel-header h3 {\n  margin: 0;\n  font-size: 1.3em;\n  font-weight: 600;\n  color: #202122;\n}\n\n.pack-count-badge {\n  padding: 6px 14px;\n  background: linear-gradient(135deg, #3366cc 0%, #447ff5 100%);\n  color: white;\n  border-radius: 20px;\n  font-size: 0.85em;\n  font-weight: 600;\n  box-shadow: 0 2px 4px rgba(51, 102, 204, 0.2);\n}\n\n.panel-content {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n/* ==================== SECTION HEADERS ==================== */\n\n.section-header {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  margin-bottom: 16px;\n}\n\n.section-icon {\n  font-size: 1.4em;\n  line-height: 1;\n}\n\n.section-header h4 {\n  margin: 0;\n  font-size: 1.1em;\n  font-weight: 600;\n  color: #202122;\n}\n\n/* ==================== WARNINGS SECTION ==================== */\n\n.warnings-section {\n  animation: slideIn 0.3s ease;\n}\n\n.warnings-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n/* ==================== PACK CARDS ==================== */\n/* Most styling is inline (see template), CSS here is for fallback/animations only */\n\n.packs-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.pack-card:hover {\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15), 0 2px 6px rgba(0, 0, 0, 0.1) !important;\n  transform: translateY(-3px);\n}\n\n.status-icon {\n  font-size: 1.1em;\n  line-height: 1;\n}\n\n.status-icon.spinning {\n  display: inline-block;\n  animation: spin 2s linear infinite;\n}\n\n.status-text {\n  font-weight: 600;\n}\n\n/* ==================== EMPTY STATE ==================== */\n\n.empty-state {\n  text-align: center;\n  padding: 40px 20px;\n  background: linear-gradient(135deg, #fafbfc 0%, #f8f9fa 100%);\n  border-radius: 8px;\n  border: 2px dashed #c8ccd1;\n}\n\n.empty-icon {\n  font-size: 3em;\n  margin-bottom: 10px;\n  opacity: 0.4;\n}\n\n.empty-text {\n  margin: 0 0 8px 0;\n  font-size: 1.1em;\n  font-weight: 600;\n  color: #54595d;\n}\n\n.empty-hint {\n  margin: 0;\n  font-size: 0.9em;\n  color: #72777d;\n}\n\n/* ==================== ACTIONS SECTION ==================== */\n\n.actions-section {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  padding-top: 16px;\n  border-top: 2px solid #eaecf0;\n}\n\n.action-buttons {\n  display: flex;\n  gap: 12px;\n  flex-wrap: wrap;\n}\n\n.action-buttons :deep(.cdx-button) {\n  border-radius: 8px;\n  font-weight: 600;\n  padding: 10px 20px;\n  transition: all 0.2s ease;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);\n}\n\n.action-buttons :deep(.cdx-button:hover:not(:disabled)) {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);\n}\n\n.action-buttons :deep(.cdx-button:active:not(:disabled)) {\n  transform: translateY(0);\n}\n\n.state-info {\n  padding: 10px 14px;\n  background: linear-gradient(135deg, #f8f9fa 0%, #eaecf0 100%);\n  border-radius: 6px;\n  border: 1px solid #c8ccd1;\n}\n\n.state-info small {\n  color: #54595d;\n  font-size: 0.85em;\n}\n\n.state-info code {\n  font-family: 'Monaco', 'Menlo', 'Consolas', monospace;\n  font-size: 0.9em;\n  color: #202122;\n  background: white;\n  padding: 2px 6px;\n  border-radius: 3px;\n  border: 1px solid #c8ccd1;\n}\n\n/* ==================== ANIMATIONS ==================== */\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n@keyframes pulse {\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0.8; }\n}\n\n@keyframes slideIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n/* ==================== RESPONSIVE ==================== */\n\n@media (max-width: 768px) {\n  .pack-header {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n  \n  .operation-status {\n    align-self: flex-start;\n  }\n  \n  .pack-info-grid {\n    grid-template-columns: 1fr;\n  }\n  \n  .action-buttons {\n    flex-direction: column;\n  }\n  \n  .action-buttons :deep(.cdx-button) {\n    width: 100%;\n  }\n  \n  .panel-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 12px;\n  }\n  \n  .pack-count-badge {\n    align-self: flex-start;\n  }\n}\n</style>\n\n\n\n\n","<template>\n  <div class=\"labki-pack-manager-app\">\n    <header class=\"app-header\">\n      <h1>{{ $t('labkipackmanager-special-title') }}</h1>\n      <p class=\"app-description\">{{ $t('labkipackmanager-special-description') }}</p>\n    </header>\n    \n    <div v-if=\"store.busy\" class=\"loading-overlay\">\n      <div class=\"loading-spinner\">\n        {{ $t('labkipackmanager-loading') }}...\n      </div>\n    </div>\n    \n    <main class=\"app-main\">\n      <repo-ref-selector />\n      \n      <mermaid-graph\n        v-if=\"store.repoUrl && store.ref\"\n        :mermaid-src=\"store.mermaidSrc\"\n      />\n      \n      <hierarchy-tree\n        v-if=\"store.repoUrl && store.ref\"\n        :hierarchy=\"store.hierarchy\"\n      />\n      \n      <details-panel\n        v-if=\"store.repoUrl && store.ref\"\n      />\n    </main>\n  </div>\n</template>\n\n<script setup>\nimport { onMounted } from 'vue';\nimport { store } from '../state/store';\nimport RepoRefSelector from './RepoRefSelector.vue';\nimport MermaidGraph from './MermaidGraph.vue';\nimport HierarchyTree from './HierarchyTree.vue';\nimport DetailsPanel from './DetailsPanel.vue';\n\nonMounted(() => {\n  console.log('Labki Pack Manager initialized');\n});\n\n// Helper for i18n\nfunction $t(key) {\n  return mw.msg(key);\n}\n</script>\n\n<style scoped>\n.labki-pack-manager-app {\n  max-width: 1400px;\n  margin: 0 auto;\n  padding: 20px;\n  position: relative;\n}\n\n.app-header {\n  margin-bottom: 24px;\n  padding-bottom: 16px;\n  border-bottom: 2px solid #eaecf0;\n}\n\n.app-header h1 {\n  margin: 0 0 8px 0;\n  font-size: 2em;\n  font-weight: 600;\n}\n\n.app-description {\n  margin: 0;\n  color: #54595d;\n  font-size: 1.05em;\n}\n\n.loading-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.8);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.loading-spinner {\n  padding: 24px 48px;\n  background: white;\n  border: 2px solid #36c;\n  border-radius: 8px;\n  font-size: 1.2em;\n  color: #36c;\n  font-weight: 600;\n}\n\n.app-main {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n</style>\n\n",null],"names":["store","reactive","repoUrl","ref","mermaidSrc","hierarchy","packs","stateHash","warnings","busy","selectedRepo","repos","getApi","mw","Api","async","apiCall","fn","error","console","reposAdd","defaultRef","api","log","repo_url","default_ref","response","post","action","format","Object","keys","data","labkiReposAdd","graphGet","get","labkiGraphGet","graph","Error","hierarchyGet","labkiHierarchyGet","packsAction","payload","JSON","stringify","labkiPacksAction","operationStatus","operationId","operation_id","status","pollOperation","maxAttempts","intervalMs","onProgress","attempt","progress","message","Promise","resolve","setTimeout","props","__props","emit","__emit","isOpen","computed","modelValue","set","value","urlError","statusMessage","isValid","trim","validateUrl","url","URL","match","msg","onSubmit","repoUrlValue","defaultRefValue","onCancel","e","String","$t","key","_createBlock","_unref","CdxDialog","open","$event","title","disabled","onPrimary","onDefault","_createElementVNode","_hoisted_1","_createVNode","CdxField","_createSlots","label","CdxTextInput","placeholder","_hoisted_2","_toDisplayString","CdxMessage","type","inline","refName","refNameValue","_createTextVNode","ADD_REPO_VALUE","ADD_REF_VALUE","selectedRepoUrl","selectedRefName","showAddRepoModal","showAddRefModal","repoMenuItems","length","items","map","repo","push","refMenuItems","refs","ref_name","is_default","loadRepos","labkiReposList","meta","reposList","selectRepo","onRepoSelected","find","r","defaultRefObj","selectRef","onRefSelected","graphResponse","hierarchyResponse","all","lines","nodes","Set","edges","edge","containsEdges","add","from","to","dependsEdges","node","nodeId","escapeNodeName","prefix","nameParts","split","displayName","join","icon","fromNode","toNode","buildMermaidFromGraph","initResponse","command","diff","state_hash","onRepoAdded","eventData","onRefAdded","name","replace","onMounted","_openBlock","_createElementBlock","_hoisted_3","CdxSelect","selected","_hoisted_4","_hoisted_5","AddRepoModal","onAdded","AddRefModal","hasMermaid","mermaidPre","state","loader","getState","warn","checkMermaidAvailability","watch","nextTick","window","mermaid","initialize","startOnLoad","theme","securityLevel","svgs","querySelectorAll","forEach","svg","remove","innerHTML","removeAttribute","run","contentLoaded","triggerMermaidRender","class","mergeDiff","target","packName","packChanges","entries","existing","mergePack","dst","src","out","pages","pageName","pageChanges","existingPage","mergePage","expanded","prefixTimer","pageTimer","children","packState","isPackEditable","installed","showPackEditor","prefixInputValue","nodePackName","parentName","parentPackName","parentPackState","pageState","isPageEditable","showPageEditor","pageParentAction","displayPrefix","displayPrefixWithSlash","endsWith","pageEditableTitle","full","final_title","pref","startsWith","slice","pageHasCollision","some","w","includes","collisionTooltip","filter","collisionId","canUpdate","ps","current_version","target_version","newAction","oldAction","subtreeHasAction","check","n","s","c","toggleExpanded","toggleAction","current","next","pack_name","toggleInstall","toggleRemove","toggleUpdate","onPrefixChange","val","clearTimeout","sendSetPackPrefixCommand","onPageTitleChange","editable","newTitle","page_name","new_title","sendRenamePageCommandLegacy","k","getPageState","parentPack","getPageBackground","getDisplayPrefix","getDisplayPrefixWithSlash","getPageEditableTitle","getPageHasCollision","getCollisionTooltip","getPageEditable","onPageTitleChangeForPage","sendRenamePageCommand","depth","onBeforeUnmount","arr","ci","toLocaleLowerCase","sort","a","b","la","lb","childPages","child","childPacks","onChildrenEnter","el","style","height","opacity","offsetHeight","transition","scrollHeight","onChildrenLeave","_createCommentVNode","_normalizeClass","_normalizeStyle","background","flex","toString","onClick","_cache","_hoisted_6","_hoisted_7","_hoisted_8","version","auto_selected_reason","_hoisted_9","_hoisted_10","fontSize","color","fontWeight","readonly","onInput","_hoisted_12","CdxButton","weight","active","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_Fragment","_renderList","page","id","_hoisted_17","_hoisted_18","_hoisted_19","onFocus","_hoisted_21","description","depends_on","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_Transition","onEnter","onLeave","_hoisted_26","_component_tree_node","onSetPackAction","$emit","_hoisted_27","_hoisted_28","_hoisted_29","undefined","_hoisted_31","sendCommand","pack_count","page_count","root_nodes","TreeNode","operationMessage","errorMessage","packStatuses","selectedPacks","pageCount","onApply","pack","operation","installMatch","updateMatch","removeMatch","completeMatch","updatePackStatusFromMessage","getStatusText","getActionIcon","onRefresh","onClear","confirm","warning","index","_hoisted_11","lineHeight","_hoisted_20","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","RepoRefSelector","MermaidGraph","HierarchyTree","DetailsPanel","using","then","root","document","getElementById","createApp","App","mount","initApp","catch"],"mappings":"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"}